NODELIST=gammagpu11
MASTER_ADDR=gammagpu11
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/bin/accelerate", line 8, in <module>
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    sys.exit(main())
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    args.func(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1097, in launch_command
    args.func(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1097, in launch_command
    args.func(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1097, in launch_command
    multi_gpu_launcher(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 734, in multi_gpu_launcher
    multi_gpu_launcher(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 734, in multi_gpu_launcher
    multi_gpu_launcher(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 734, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in run
    distrib_run.run(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in run
    distrib_run.run(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 133, in __call__
    elastic_launch(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 133, in __call__
    elastic_launch(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 133, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 255, in launch_agent
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 255, in launch_agent
    result = agent.run()
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    result = agent.run()
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 680, in run
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 680, in run
    result = self._invoke_run(role)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 829, in _invoke_run
    result = self._invoke_run(role)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 829, in _invoke_run
    self._initialize_workers(self._worker_group)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 652, in _initialize_workers
    self._initialize_workers(self._worker_group)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 652, in _initialize_workers
    self._rendezvous(worker_group)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 255, in launch_agent
    result = agent.run()
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 680, in run
    self._rendezvous(worker_group)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 489, in _rendezvous
    result = self._invoke_run(role)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 829, in _invoke_run
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 489, in _rendezvous
    rdzv_info = spec.rdzv_handler.next_rendezvous()
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/static_tcp_rendezvous.py", line 66, in next_rendezvous
    rdzv_info = spec.rdzv_handler.next_rendezvous()
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/static_tcp_rendezvous.py", line 66, in next_rendezvous
    self._store = TCPStore(  # type: ignore[call-arg]
RuntimeError: The server socket has failed to listen on any local network address. useIpv6: 0, code: -98, name: EADDRINUSE, message: address already in use
    self._initialize_workers(self._worker_group)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    self._store = TCPStore(  # type: ignore[call-arg]
RuntimeError: The server socket has failed to listen on any local network address. useIpv6: 0, code: -98, name: EADDRINUSE, message: address already in use
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 652, in _initialize_workers
    self._rendezvous(worker_group)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/metrics/api.py", line 124, in wrapper
    result = f(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/agent/server/api.py", line 489, in _rendezvous
    rdzv_info = spec.rdzv_handler.next_rendezvous()
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/elastic/rendezvous/static_tcp_rendezvous.py", line 66, in next_rendezvous
    self._store = TCPStore(  # type: ignore[call-arg]
RuntimeError: The server socket has failed to listen on any local network address. useIpv6: 0, code: -98, name: EADDRINUSE, message: address already in use
srun: error: gammagpu11: tasks 0,2-3: Exited with exit code 1
WARNING:accelerate.utils.other:Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
wandb: Currently logged in as: sjxu (sjxu_gamma). Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: sjxu (sjxu_gamma). Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /fs/nexus-scratch/sjxu/.netrc
wandb: Appending key for api.wandb.ai to your netrc file: /fs/nexus-scratch/sjxu/.netrc
INFO:__main__:Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 4
Process index: 1
Local process index: 1
Device: cuda:1

Mixed precision type: fp16

INFO:__main__:Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 4
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: fp16

{'final_sigmas_type', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
wandb: Currently logged in as: sjxu (sjxu_gamma). Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: sjxu (sjxu_gamma). Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /fs/nexus-scratch/sjxu/.netrc
wandb: Appending key for api.wandb.ai to your netrc file: /fs/nexus-scratch/sjxu/.netrc
INFO:__main__:Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 4
Process index: 2
Local process index: 2
Device: cuda:2

Mixed precision type: fp16

INFO:__main__:Distributed environment: MULTI_GPU  Backend: nccl
Num processes: 4
Process index: 3
Local process index: 3
Device: cuda:3

Mixed precision type: fp16

prediction_type:prediction_type:  v_predictionv_prediction

prediction_type: v_prediction
prediction_type: v_prediction
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/lpips/weights/v0.1/alex.pth
Loading model from: /fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/lpips/weights/v0.1/alex.pth
Loading model from: /fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/lpips/weights/v0.1/alex.pth
Loading model from: /fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/lpips/weights/v0.1/alex.pth
FrozenDict([('sample_size', 96), ('in_channels', 8), ('out_channels', 4), ('down_block_types', ['CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'DownBlockSpatioTemporal']), ('up_block_types', ['UpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal']), ('block_out_channels', [320, 640, 1280, 1280]), ('addition_time_embed_dim', 256), ('projection_class_embeddings_input_dim', 768), ('layers_per_block', 2), ('cross_attention_dim', 1024), ('transformer_layers_per_block', 1), ('num_attention_heads', [5, 10, 20, 20]), ('num_frames', 14), ('_class_name', 'UNetSpatioTemporalConditionControlNetModel'), ('_diffusers_version', '0.24.0.dev0'), ('_name_or_path', 'stabilityai/stable-video-diffusion-img2vid')])
layers per block is 2
INFO:__main__:Initializing controlnet weights from unet
FrozenDict([('sample_size', 96), ('in_channels', 8), ('out_channels', 4), ('down_block_types', ['CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'DownBlockSpatioTemporal']), ('up_block_types', ['UpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal']), ('block_out_channels', [320, 640, 1280, 1280]), ('addition_time_embed_dim', 256), ('projection_class_embeddings_input_dim', 768), ('layers_per_block', 2), ('cross_attention_dim', 1024), ('transformer_layers_per_block', 1), ('num_attention_heads', [5, 10, 20, 20]), ('num_frames', 14), ('_class_name', 'UNetSpatioTemporalConditionControlNetModel'), ('_diffusers_version', '0.24.0.dev0'), ('_name_or_path', 'stabilityai/stable-video-diffusion-img2vid')])
layers per block is 2
FrozenDict([('sample_size', 96), ('in_channels', 8), ('out_channels', 4), ('down_block_types', ['CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'DownBlockSpatioTemporal']), ('up_block_types', ['UpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal']), ('block_out_channels', [320, 640, 1280, 1280]), ('addition_time_embed_dim', 256), ('projection_class_embeddings_input_dim', 768), ('layers_per_block', 2), ('cross_attention_dim', 1024), ('transformer_layers_per_block', 1), ('num_attention_heads', [5, 10, 20, 20]), ('num_frames', 14), ('_class_name', 'UNetSpatioTemporalConditionControlNetModel'), ('_diffusers_version', '0.24.0.dev0'), ('_name_or_path', 'stabilityai/stable-video-diffusion-img2vid')])
FrozenDict([('sample_size', 96), ('in_channels', 8), ('out_channels', 4), ('down_block_types', ['CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'CrossAttnDownBlockSpatioTemporal', 'DownBlockSpatioTemporal']), ('up_block_types', ['UpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal', 'CrossAttnUpBlockSpatioTemporal']), ('block_out_channels', [320, 640, 1280, 1280]), ('addition_time_embed_dim', 256), ('projection_class_embeddings_input_dim', 768), ('layers_per_block', 2), ('cross_attention_dim', 1024), ('transformer_layers_per_block', 1), ('num_attention_heads', [5, 10, 20, 20]), ('num_frames', 14), ('_class_name', 'UNetSpatioTemporalConditionControlNetModel'), ('_diffusers_version', '0.24.0.dev0'), ('_name_or_path', 'stabilityai/stable-video-diffusion-img2vid')])
layers per block is 2
layers per block is 2
modify_layers in progress: torch.Size([6, 1, 16])
modify_layers in progress: 16 320
modify_layers in progress: torch.Size([6, 1, 16])
modify_layers in progress: 16 320
modify_layers in progress: torch.Size([6, 1, 16])
modify_layers in progress: 16 320
modify_layers in progress: torch.Size([6, 1, 16])
modify_layers in progress: 16 320
data scale: 5910
length 5910
sample size (512, 512)
data scale: 5910
length 5910
sample size (512, 512)
data scale: 5910
length 5910
sample size (512, 512)
data scale: 5910
length 5910
sample size (512, 512)
gammagpu11:1849881:1849881 [0] NCCL INFO Bootstrap : Using bond0:192.168.44.22<0>
gammagpu11:1849881:1849881 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
gammagpu11:1849881:1849881 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.20.5+cuda12.4
gammagpu11:1849882:1849882 [1] NCCL INFO cudaDriverVersion 12040
gammagpu11:1849883:1849883 [2] NCCL INFO cudaDriverVersion 12040
gammagpu11:1849884:1849884 [3] NCCL INFO cudaDriverVersion 12040
gammagpu11:1849882:1849882 [1] NCCL INFO Bootstrap : Using bond0:192.168.44.22<0>
gammagpu11:1849883:1849883 [2] NCCL INFO Bootstrap : Using bond0:192.168.44.22<0>
gammagpu11:1849884:1849884 [3] NCCL INFO Bootstrap : Using bond0:192.168.44.22<0>
gammagpu11:1849882:1849882 [1] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
gammagpu11:1849884:1849884 [3] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
gammagpu11:1849883:1849883 [2] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
gammagpu11:1849882:1850021 [1] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
gammagpu11:1849881:1850020 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
gammagpu11:1849884:1850023 [3] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
gammagpu11:1849883:1850022 [2] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
gammagpu11:1849881:1850020 [0] NCCL INFO NET/Socket : Using [0]bond0:192.168.44.22<0> [1]virbr0:192.168.122.1<0> [2]enp67s0f3u2u3c2:fe80::2c48:4bff:fe0d:ac77%enp67s0f3u2u3c2<0>
gammagpu11:1849882:1850021 [1] NCCL INFO NET/Socket : Using [0]bond0:192.168.44.22<0> [1]virbr0:192.168.122.1<0> [2]enp67s0f3u2u3c2:fe80::2c48:4bff:fe0d:ac77%enp67s0f3u2u3c2<0>
gammagpu11:1849883:1850022 [2] NCCL INFO NET/Socket : Using [0]bond0:192.168.44.22<0> [1]virbr0:192.168.122.1<0> [2]enp67s0f3u2u3c2:fe80::2c48:4bff:fe0d:ac77%enp67s0f3u2u3c2<0>
gammagpu11:1849884:1850023 [3] NCCL INFO NET/Socket : Using [0]bond0:192.168.44.22<0> [1]virbr0:192.168.122.1<0> [2]enp67s0f3u2u3c2:fe80::2c48:4bff:fe0d:ac77%enp67s0f3u2u3c2<0>
gammagpu11:1849882:1850021 [1] NCCL INFO Using non-device net plugin version 0
gammagpu11:1849884:1850023 [3] NCCL INFO Using non-device net plugin version 0
gammagpu11:1849882:1850021 [1] NCCL INFO Using network Socket
gammagpu11:1849881:1850020 [0] NCCL INFO Using non-device net plugin version 0
gammagpu11:1849883:1850022 [2] NCCL INFO Using non-device net plugin version 0
gammagpu11:1849884:1850023 [3] NCCL INFO Using network Socket
gammagpu11:1849881:1850020 [0] NCCL INFO Using network Socket
gammagpu11:1849883:1850022 [2] NCCL INFO Using network Socket
gammagpu11:1849882:1850021 [1] NCCL INFO comm 0x56483f4db000 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 41000 commId 0x23e7ce28fe8e77c9 - Init START
gammagpu11:1849881:1850020 [0] NCCL INFO comm 0x5576089e0ac0 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x23e7ce28fe8e77c9 - Init START
gammagpu11:1849884:1850023 [3] NCCL INFO comm 0x55e711f776c0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId c1000 commId 0x23e7ce28fe8e77c9 - Init START
gammagpu11:1849883:1850022 [2] NCCL INFO comm 0x55fbad9d8200 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 81000 commId 0x23e7ce28fe8e77c9 - Init START
gammagpu11:1849884:1850023 [3] NCCL INFO NVLS multicast support is not available on dev 3
gammagpu11:1849881:1850020 [0] NCCL INFO NVLS multicast support is not available on dev 0
gammagpu11:1849882:1850021 [1] NCCL INFO NVLS multicast support is not available on dev 1
gammagpu11:1849883:1850022 [2] NCCL INFO NVLS multicast support is not available on dev 2
gammagpu11:1849883:1850022 [2] NCCL INFO comm 0x55fbad9d8200 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
gammagpu11:1849884:1850023 [3] NCCL INFO comm 0x55e711f776c0 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
gammagpu11:1849883:1850022 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/-1/-1->2->1 [3] 3/-1/-1->2->1
gammagpu11:1849883:1850022 [2] NCCL INFO P2P Chunksize set to 131072
gammagpu11:1849884:1850023 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2
gammagpu11:1849884:1850023 [3] NCCL INFO P2P Chunksize set to 131072
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/CUMEM
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/CUMEM
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 02/0 : 2[2] -> 3[3] via P2P/CUMEM
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 03/0 : 2[2] -> 3[3] via P2P/CUMEM
gammagpu11:1849881:1850020 [0] NCCL INFO comm 0x5576089e0ac0 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 00/04 :    0   1   2   3
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 01/04 :    0   1   2   3
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 02/04 :    0   1   2   3
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 03/04 :    0   1   2   3
gammagpu11:1849881:1850020 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 1/-1/-1->0->-1 [3] 1/-1/-1->0->-1
gammagpu11:1849881:1850020 [0] NCCL INFO P2P Chunksize set to 131072
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/CUMEM
gammagpu11:1849881:1850020 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO comm 0x56483f4db000 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
gammagpu11:1849882:1850021 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 2/-1/-1->1->0 [3] 2/-1/-1->1->0
gammagpu11:1849882:1850021 [1] NCCL INFO P2P Chunksize set to 131072
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 02/0 : 1[1] -> 2[2] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 03/0 : 1[1] -> 2[2] via P2P/CUMEM
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 00/0 : 3[3] -> 0[0] via P2P/CUMEM
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 01/0 : 3[3] -> 0[0] via P2P/CUMEM
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 02/0 : 3[3] -> 0[0] via P2P/CUMEM
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 03/0 : 3[3] -> 0[0] via P2P/CUMEM
gammagpu11:1849881:1850020 [0] NCCL INFO Connected all rings
gammagpu11:1849884:1850023 [3] NCCL INFO Connected all rings
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Connected all rings
gammagpu11:1849883:1850022 [2] NCCL INFO Connected all rings
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/CUMEM
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 02/0 : 3[3] -> 2[2] via P2P/CUMEM
gammagpu11:1849884:1850023 [3] NCCL INFO Channel 03/0 : 3[3] -> 2[2] via P2P/CUMEM
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/CUMEM
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 02/0 : 1[1] -> 0[0] via P2P/CUMEM
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 02/0 : 2[2] -> 1[1] via P2P/CUMEM
gammagpu11:1849882:1850021 [1] NCCL INFO Channel 03/0 : 1[1] -> 0[0] via P2P/CUMEM
gammagpu11:1849883:1850022 [2] NCCL INFO Channel 03/0 : 2[2] -> 1[1] via P2P/CUMEM
gammagpu11:1849881:1850020 [0] NCCL INFO Connected all trees
gammagpu11:1849881:1850020 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
gammagpu11:1849881:1850020 [0] NCCL INFO 4 coll channels, 0 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
gammagpu11:1849882:1850021 [1] NCCL INFO Connected all trees
gammagpu11:1849882:1850021 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
gammagpu11:1849882:1850021 [1] NCCL INFO 4 coll channels, 0 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
gammagpu11:1849884:1850023 [3] NCCL INFO Connected all trees
gammagpu11:1849884:1850023 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
gammagpu11:1849884:1850023 [3] NCCL INFO 4 coll channels, 0 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
gammagpu11:1849883:1850022 [2] NCCL INFO Connected all trees
gammagpu11:1849883:1850022 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
gammagpu11:1849883:1850022 [2] NCCL INFO 4 coll channels, 0 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
gammagpu11:1849884:1850023 [3] NCCL INFO comm 0x55e711f776c0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId c1000 commId 0x23e7ce28fe8e77c9 - Init COMPLETE
gammagpu11:1849881:1850020 [0] NCCL INFO comm 0x5576089e0ac0 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x23e7ce28fe8e77c9 - Init COMPLETE
gammagpu11:1849883:1850022 [2] NCCL INFO comm 0x55fbad9d8200 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 81000 commId 0x23e7ce28fe8e77c9 - Init COMPLETE
gammagpu11:1849882:1850021 [1] NCCL INFO comm 0x56483f4db000 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 41000 commId 0x23e7ce28fe8e77c9 - Init COMPLETE
wandb: Tracking run with wandb version 0.17.8
wandb: Run data is saved locally in /fs/nexus-scratch/sjxu/svd-temporal-controlnet/wandb/run-20241211_023047-bq5nf7rx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run effortless-terrain-172
wandb: ⭐️ View project at https://wandb.ai/sjxu_gamma/SVD_Con_Mul
wandb: 🚀 View run at https://wandb.ai/sjxu_gamma/SVD_Con_Mul/runs/bq5nf7rx
INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 4728
INFO:__main__:  Num Epochs = 120
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 64
INFO:__main__:  Gradient Accumulation steps = 16
INFO:__main__:  Total optimization steps = 8880
before controlnet:before controlnet:before controlnet:  torch.Size([1, 6, 8, 64, 64])torch.Size([1, 6, 8, 64, 64]) before controlnet: torch.Size([1])torch.Size([1])  torch.Size([1, 77, 1024])torch.Size([1, 77, 1024])   torch.Size([1, 3])torch.Size([1, 3])  torch.Size([1, 6, 4, 512, 512])torch.Size([1, 6, 4, 512, 512])  torch.Size([1, 6, 8, 64, 64])torch.Size([1, 6, 1, 16])torch.Size([1, 6, 1, 16]) torch.Size([1]) 

torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
1 61
 6
1 6
emb emb torch.Size([1, 320]) torch.Size([1, 96])
torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
embemb torch.Size([1, 1280])
 emb torch.Size([1, 1280])
torch.Size([1, 1280])
before downsample:before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: before downsample:torch.Size([6, 320, 64, 64])  torch.Size([6, 1280]) torch.Size([6, 77, 1024])torch.Size([6, 320, 64, 64])
 torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3])before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
  0%|          | 0/8880 [00:00<?, ?it/s]Steps:   0%|          | 0/8880 [00:00<?, ?it/s]Steps:   0%|          | 0/8880 [00:11<?, ?it/s, lr=0.0001, step_loss=0.993]Steps:   0%|          | 0/8880 [00:12<?, ?it/s, lr=0.0001, step_loss=0.163]Steps:   0%|          | 0/8880 [00:14<?, ?it/s, lr=0.0001, step_loss=0.54] Steps:   0%|          | 0/8880 [00:15<?, ?it/s, lr=0.0001, step_loss=0.201]Steps:   0%|          | 0/8880 [00:17<?, ?it/s, lr=0.0001, step_loss=0.121]Steps:   0%|          | 0/8880 [00:18<?, ?it/s, lr=0.0001, step_loss=0.118]Steps:   0%|          | 0/8880 [00:19<?, ?it/s, lr=0.0001, step_loss=0.595]Steps:   0%|          | 0/8880 [00:21<?, ?it/s, lr=0.0001, step_loss=0.769]Steps:   0%|          | 0/8880 [00:22<?, ?it/s, lr=0.0001, step_loss=0.102]Steps:   0%|          | 0/8880 [00:24<?, ?it/s, lr=0.0001, step_loss=0.159]Steps:   0%|          | 0/8880 [00:25<?, ?it/s, lr=0.0001, step_loss=0.105]Steps:   0%|          | 0/8880 [00:26<?, ?it/s, lr=0.0001, step_loss=0.193]Steps:   0%|          before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
| 0/8880 [00:28<?, ?it/s, lr=0.0001, step_loss=0.0796]Steps:   0%|          | 0/8880 [00:29<?, ?it/s, lr=0.0001, step_loss=0.259] Steps:   0%|          | 0/8880 [00:30<?, ?it/s, lr=0.0001, step_loss=0.275][rank2]:[W1211 02:31:23.276794521 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank1]:[W1211 02:31:23.330823318 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank0]:[W1211 02:31:23.393170046 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank3]:[W1211 02:31:23.497878858 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
Steps:   0%|          | 1/8880 [00:32<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.275]INFO:__main__:Running validation... 
 Generating 1 videos.
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
{'insert_light', 'controlnet'} was not found in config. Values will be initialized to default values.

Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s][ALoaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'final_sigmas_type', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 282.33it/s]
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: before controlnet: torch.Size([1, 6, 8, 64, 64])torch.Size([1, 6, 8, 64, 64])  torch.Size([1])torch.Size([1])  torch.Size([1, 77, 1024])torch.Size([1, 77, 1024])  torch.Size([1, 3])torch.Size([1, 3])  torch.Size([1, 6, 4, 512, 512])torch.Size([1, 6, 4, 512, 512])  torch.Size([1, 6, 1, 16])torch.Size([1, 6, 1, 16])

11  6
6
embemb  torch.Size([1, 320])torch.Size([1, 320])  torch.Size([1, 96])torch.Size([1, 96])

embemb  torch.Size([1, 1280])
torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) before downsample:torch.Size([1, 77, 1024]) torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
Steps:   0%|          | 1/8880 [00:53<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.136]Steps:   0%|          | 1/8880 [00:54<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.172]Steps:   0%|          | 1/8880 [00:55<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.17] Steps:   0%|          | 1/8880 [00:56<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.152]Steps:   0%|          | 1/8880 [00:58<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.213]Steps:   0%|          | 1/8880 [00:59<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.202]Steps:   0%|          | 1/8880 [01:00<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.0957]Steps:   0%|          | 1/8880 [01:02<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.974] Steps:   0%|          | 1/8880 [01:03<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.335]Steps:   0%|          | 1/8880 [01:04<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.118]Steps:   0%|          | 1/8880 [01:06<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.0865]Steps:   0%|          | 1/8880 [01:07<81:04:24, 32.87s/it, lr=0before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
 emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])before controlnet: torch.Size([1, 6, 8, 64, 64])
 torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet:  torch.Size([1, 6, 8, 64, 64])torch.Size([1, 6, 8, 64, 64])  torch.Size([1])torch.Size([1])  torch.Size([1, 77, 1024])torch.Size([1, 77, 1024])  torch.Size([1, 3])torch.Size([1, 3])  torch.Size([1, 6, 4, 512, 512])torch.Size([1, 6, 4, 512, 512])  torch.Size([1, 6, 1, 16])torch.Size([1, 6, 1, 16])

11  66

embemb  torch.Size([1, 320]) torch.Size([1, 320])torch.Size([1, 96]) 
torch.Size([1, 96])
embemb  torch.Size([1, 1280])torch.Size([1, 1280])

before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet:emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
embbefore downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
.0001, step_loss=0.49]  Steps:   0%|          | 1/8880 [01:08<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.208]Steps:   0%|          | 1/8880 [01:10<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.191]Steps:   0%|          | 1/8880 [01:11<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.198]Steps:   0%|          | 1/8880 [01:12<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.082]Steps:   0%|          | 2/8880 [01:14<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.082]Steps:   0%|          | 2/8880 [01:14<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.121]Steps:   0%|          | 2/8880 [01:15<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.551]Steps:   0%|          | 2/8880 [01:17<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0966]Steps:   0%|          | 2/8880 [01:18<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0953]Steps:   0%|          | 2/8880 [01:20<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.488] Steps:   0%|          | 2/8880 [01:21<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.222]Steps:   0%|          | 2/8880 [01:22<9before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
4:00:39, 38.12s/it, lr=0.0001, step_loss=0.11] Steps:   0%|          | 2/8880 [01:24<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0968]Steps:   0%|          | 2/8880 [01:25<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.206] Steps:   0%|          | 2/8880 [01:26<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0742]Steps:   0%|          | 2/8880 [01:28<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.128] Steps:   0%|          | 2/8880 [01:29<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.152]Steps:   0%|          | 2/8880 [01:30<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.427]Steps:   0%|          | 2/8880 [01:32<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.193]Steps:   0%|          | 2/8880 [01:33<94:00:39, 38.12s/it, lr=0.0001, step_loss=1]    Steps:   0%|          | 2/8880 [01:34<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0873]Steps:   0%|          | 3/8880 [01:36<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0873]Steps:   0%|          | 3/8880 [01:36<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.135] Steps:   0%|before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
          | 3/8880 [01:37<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0822]Steps:   0%|          | 3/8880 [01:39<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.138] Steps:   0%|          | 3/8880 [01:40<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.116]Steps:   0%|          | 3/8880 [01:41<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.384]Steps:   0%|          | 3/8880 [01:43<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.846]Steps:   0%|          | 3/8880 [01:44<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.14] Steps:   0%|          | 3/8880 [01:45<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0681]Steps:   0%|          | 3/8880 [01:47<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0446]Steps:   0%|          | 3/8880 [01:48<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.194] Steps:   0%|          | 3/8880 [01:49<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.151]Steps:   0%|          | 3/8880 [01:51<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0451]Steps:   0%|          | 3/8880 [01:52<75:41:26, 30.70s/it, lr=0.0001, stebefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64])emb torch.Size([1, 320]) torch.Size([1, 96])
 torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])emb torch.Size([1, 1280])

1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
p_loss=0.0714]Steps:   0%|          | 3/8880 [01:54<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.238] Steps:   0%|          | 3/8880 [01:55<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.083]Steps:   0%|          | 3/8880 [01:56<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0686]Steps:   0%|          | 4/8880 [01:58<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0686]Steps:   0%|          | 4/8880 [01:58<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.138] Steps:   0%|          | 4/8880 [01:59<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0858]Steps:   0%|          | 4/8880 [02:00<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.338] Steps:   0%|          | 4/8880 [02:02<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0967]Steps:   0%|          | 4/8880 [02:03<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.24]  Steps:   0%|          | 4/8880 [02:04<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.593]Steps:   0%|          | 4/8880 [02:06<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0865]Steps:   0%|          | 4/8880 [02:07<66:58before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512])  torch.Size([1, 6, 1, 16])
torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
1 emb 6torch.Size([1, 320]) torch.Size([1, 96])

emb torch.Size([1, 1280])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
:54, 27.17s/it, lr=0.0001, step_loss=0.0956]Steps:   0%|          | 4/8880 [02:08<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0872]Steps:   0%|          | 4/8880 [02:10<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0505]Steps:   0%|          | 4/8880 [02:11<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0814]Steps:   0%|          | 4/8880 [02:13<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0895]Steps:   0%|          | 4/8880 [02:14<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.171] Steps:   0%|          | 4/8880 [02:15<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.235]Steps:   0%|          | 4/8880 [02:17<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.142]Steps:   0%|          | 4/8880 [02:18<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.185]Steps:   0%|          | 5/8880 [02:20<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.185]Steps:   0%|          | 5/8880 [02:20<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.115]Steps:   0%|          | 5/8880 [02:21<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.577]Steps:   0%|     before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
 embtorch.Size([1, 6, 8, 64, 64]) torch.Size([1, 320]) torch.Size([1, 96])
 torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512])emb torch.Size([1, 1280])
 torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
     | 5/8880 [02:22<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.125]Steps:   0%|          | 5/8880 [02:24<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.623]Steps:   0%|          | 5/8880 [02:25<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.131]Steps:   0%|          | 5/8880 [02:26<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.177]Steps:   0%|          | 5/8880 [02:27<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0748]Steps:   0%|          | 5/8880 [02:29<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0848]Steps:   0%|          | 5/8880 [02:30<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.156] Steps:   0%|          | 5/8880 [02:31<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.213]Steps:   0%|          | 5/8880 [02:33<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0868]Steps:   0%|          | 5/8880 [02:34<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.178] Steps:   0%|          | 5/8880 [02:35<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0719]Steps:   0%|          | 5/8880 [02:37<62:09:12, 25.21s/it, lr=0.0001, step_losbefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet:  torch.Size([1, 6, 8, 64, 64])torch.Size([1, 6, 8, 64, 64])  torch.Size([1])torch.Size([1])  torch.Size([1, 77, 1024])torch.Size([1, 77, 1024])  torch.Size([1, 3])torch.Size([1, 3])  torch.Size([1, 6, 4, 512, 512])torch.Size([1, 6, 4, 512, 512])  torch.Size([1, 6, 1, 16])torch.Size([1, 6, 1, 16])

11  66

embemb  torch.Size([1, 320])torch.Size([1, 320])  torch.Size([1, 96])torch.Size([1, 96])

emb embtorch.Size([1, 1280]) 
torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
embbefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
torch.Size([6, 1280])before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])

1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) before downsample:torch.Size([6, 77, 1024])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
s=0.117] Steps:   0%|          | 5/8880 [02:38<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0626]Steps:   0%|          | 5/8880 [02:39<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0509]Steps:   0%|          | 6/8880 [02:41<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.0509]Steps:   0%|          | 6/8880 [02:41<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.337] Steps:   0%|          | 6/8880 [02:42<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.198]Steps:   0%|          | 6/8880 [02:44<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.0891]Steps:   0%|          | 6/8880 [02:45<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.326] Steps:   0%|          | 6/8880 [02:47<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.0567]Steps:   0%|          | 6/8880 [02:48<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.217] Steps:   0%|          | 6/8880 [02:49<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.067]Steps:   0%|          | 6/8880 [02:50<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.907]Steps:   0%|          | 6/8880 [02:52<59:06:26, 2before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
3.98s/it, lr=0.0001, step_loss=0.152]Steps:   0%|          | 6/8880 [02:53<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.135]Steps:   0%|          | 6/8880 [02:54<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.0987]Steps:   0%|          | 6/8880 [02:56<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.183] Steps:   0%|          | 6/8880 [02:57<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.133]Steps:   0%|          | 6/8880 [02:59<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.704]Steps:   0%|          | 6/8880 [03:00<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.113]Steps:   0%|          | 6/8880 [03:02<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.0599]Steps:   0%|          | 7/8880 [03:03<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.0599]Steps:   0%|          | 7/8880 [03:03<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.212] Steps:   0%|          | 7/8880 [03:04<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.0927]Steps:   0%|          | 7/8880 [03:06<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.141] Steps:   0%|          before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 1280])torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])

1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
| 7/8880 [03:07<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.278]Steps:   0%|          | 7/8880 [03:08<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.115]Steps:   0%|          | 7/8880 [03:10<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.1]  Steps:   0%|          | 7/8880 [03:11<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.161]Steps:   0%|          | 7/8880 [03:13<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.865]Steps:   0%|          | 7/8880 [03:14<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.257]Steps:   0%|          | 7/8880 [03:15<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.0558]Steps:   0%|          | 7/8880 [03:17<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.0683]Steps:   0%|          | 7/8880 [03:18<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.112] Steps:   0%|          | 7/8880 [03:19<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.284]Steps:   0%|          | 7/8880 [03:21<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.168]Steps:   0%|          | 7/8880 [03:22<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.0376before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])torch.Size([1, 1280])

emb torch.Size([1, 320]) torch.Size([1, 96])
1 6
emb torch.Size([1, 1280])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample:before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet:emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
11 6
 6
emb torch.Size([1, 320])before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) 
torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
]Steps:   0%|          | 7/8880 [03:23<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.117] Steps:   0%|          | 8/8880 [03:25<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.117]Steps:   0%|          | 8/8880 [03:25<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0604]Steps:   0%|          | 8/8880 [03:26<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.997] Steps:   0%|          | 8/8880 [03:27<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.136]Steps:   0%|          | 8/8880 [03:29<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.238]Steps:   0%|          | 8/8880 [03:30<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.155]Steps:   0%|          | 8/8880 [03:32<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.797]Steps:   0%|          | 8/8880 [03:33<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0736]Steps:   0%|          | 8/8880 [03:34<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.113] Steps:   0%|          | 8/8880 [03:36<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.158]Steps:   0%|          | 8/8880 [03:37<56:15:01, 22.82s/it, lbefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: 1 torch.Size([1, 6, 8, 64, 64])6 
torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
emb torch.Size([1, 1280])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
r=0.0001, step_loss=0.991]Steps:   0%|          | 8/8880 [03:38<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0795]Steps:   0%|          | 8/8880 [03:40<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.122] Steps:   0%|          | 8/8880 [03:41<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0423]Steps:   0%|          | 8/8880 [03:42<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.163] Steps:   0%|          | 8/8880 [03:43<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0946]Steps:   0%|          | 8/8880 [03:45<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.195] Steps:   0%|          | 9/8880 [03:46<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.195]Steps:   0%|          | 9/8880 [03:46<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0712]Steps:   0%|          | 9/8880 [03:48<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.336] Steps:   0%|          | 9/8880 [03:49<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0671]Steps:   0%|          | 9/8880 [03:50<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.14]  Steps:   0%|          | 9/8880before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet:before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 [03:52<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.132]Steps:   0%|          | 9/8880 [03:53<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.118]Steps:   0%|          | 9/8880 [03:55<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.206]Steps:   0%|          | 9/8880 [03:56<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0579]Steps:   0%|          | 9/8880 [03:57<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0882]Steps:   0%|          | 9/8880 [03:59<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0665]Steps:   0%|          | 9/8880 [04:00<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.159] Steps:   0%|          | 9/8880 [04:01<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.222]Steps:   0%|          | 9/8880 [04:03<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0772]Steps:   0%|          | 9/8880 [04:04<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0787]Steps:   0%|          | 9/8880 [04:05<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.102] Steps:   0%|          | 9/8880 [04:07<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.149]Stebefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet:  torch.Size([1, 6, 8, 64, 64])torch.Size([1, 6, 8, 64, 64])  torch.Size([1])torch.Size([1])  torch.Size([1, 77, 1024])torch.Size([1, 77, 1024])  torch.Size([1, 3])torch.Size([1, 3])  torch.Size([1, 6, 4, 512, 512])torch.Size([1, 6, 4, 512, 512])  torch.Size([1, 6, 1, 16])torch.Size([1, 6, 1, 16])

11  66

embemb  torch.Size([1, 320]) torch.Size([1, 320]) torch.Size([1, 96])
torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
 6
1 6
embemb torch.Size([1, 320]) torch.Size([1, 96])
 torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024])before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3])  torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
 1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
torch.Size([1, 6, 8, 64, 64])emb torch.Size([1, 1280])
 torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before downsample:emb torch.Size([1, 320]) torch.Size([1, 96])
 emb torch.Size([1, 1280])
torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
ps:   0%|          | 10/8880 [04:08<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.149]Steps:   0%|          | 10/8880 [04:08<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.134]Steps:   0%|          | 10/8880 [04:10<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0665]Steps:   0%|          | 10/8880 [04:11<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.575] Steps:   0%|          | 10/8880 [04:12<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.202]Steps:   0%|          | 10/8880 [04:14<54:50:58, 22.26s/it, lr=0.0001, step_loss=1]    Steps:   0%|          | 10/8880 [04:15<54:50:58, 22.26s/it, lr=0.0001, step_loss=1.24]Steps:   0%|          | 10/8880 [04:16<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.05]Steps:   0%|          | 10/8880 [04:18<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.226]Steps:   0%|          | 10/8880 [04:19<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.25] Steps:   0%|          | 10/8880 [04:20<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0757]Steps:   0%|          | 10/8880 [04:22<54:50:58, 22.26s/itbefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1])1 6
 torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512])emb torch.Size([1, 320])  torch.Size([1, 96])
torch.Size([1, 6, 1, 16])
1emb torch.Size([1, 1280])
 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
torch.Size([6, 77, 1024])1 6

emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) before controlnet:torch.Size([1])  torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 8, 64, 64])torch.Size([1, 6, 4, 512, 512])  torch.Size([1])torch.Size([1, 6, 1, 16]) 
torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb1  6
torch.Size([1, 1280])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before downsample:1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
, lr=0.0001, step_loss=0.0995]Steps:   0%|          | 10/8880 [04:23<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.287] Steps:   0%|          | 10/8880 [04:24<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.177]Steps:   0%|          | 10/8880 [04:26<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.173]Steps:   0%|          | 10/8880 [04:27<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0296]Steps:   0%|          | 10/8880 [04:28<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0723]Steps:   0%|          | 11/8880 [04:30<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.0723]Steps:   0%|          | 11/8880 [04:30<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.22]  Steps:   0%|          | 11/8880 [04:31<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.368]Steps:   0%|          | 11/8880 [04:33<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.138]Steps:   0%|          | 11/8880 [04:34<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.12] Steps:   0%|          | 11/8880 [04:35<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.263]Steps:   0%|        before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb before downsample:torch.Size([1, 1280]) torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])

before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280])before downsample:  torch.Size([6, 77, 1024])
torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before downsample: torch.Size([6, 320, 64, 64]) emb torch.Size([6, 1280])torch.Size([1, 320]) torch.Size([1, 96])
 torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
  | 11/8880 [04:37<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.168]Steps:   0%|          | 11/8880 [04:38<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.16] Steps:   0%|          | 11/8880 [04:39<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.0837]Steps:   0%|          | 11/8880 [04:41<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.256] Steps:   0%|          | 11/8880 [04:42<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.0737]Steps:   0%|          | 11/8880 [04:43<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.195] Steps:   0%|          | 11/8880 [04:45<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.0382]Steps:   0%|          | 11/8880 [04:46<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.144] Steps:   0%|          | 11/8880 [04:47<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.147]Steps:   0%|          | 11/8880 [04:49<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.079]Steps:   0%|          | 11/8880 [04:50<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.249]Steps:   0%|          | 12/8880 [04:52<54:05:37, 21.96s/it, lr=0.0001,before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
torch.Size([6, 320, 64, 64])1 6
 emb torch.Size([1, 320]) torch.Size([1, 96])
torch.Size([6, 1280])emb torch.Size([1, 1280])
 torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
 torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet:before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 step_loss=0.249]Steps:   0%|          | 12/8880 [04:52<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.242]Steps:   0%|          | 12/8880 [04:53<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.127]Steps:   0%|          | 12/8880 [04:54<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.0764]Steps:   0%|          | 12/8880 [04:56<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.235] Steps:   0%|          | 12/8880 [04:57<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.0956]Steps:   0%|          | 12/8880 [04:58<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.103] Steps:   0%|          | 12/8880 [05:00<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.169]Steps:   0%|          | 12/8880 [05:01<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.163]Steps:   0%|          | 12/8880 [05:02<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.272]Steps:   0%|          | 12/8880 [05:04<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.518]Steps:   0%|          | 12/8880 [05:05<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.104]Steps:   0%|          | 12/8880 [0before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
5:07<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.0875]Steps:   0%|          | 12/8880 [05:08<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.113] Steps:   0%|          | 12/8880 [05:09<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.495]Steps:   0%|          | 12/8880 [05:11<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.14] Steps:   0%|          | 12/8880 [05:12<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.1] Steps:   0%|          | 13/8880 [05:14<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.1]Steps:   0%|          | 13/8880 [05:14<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.238]Steps:   0%|          | 13/8880 [05:15<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.097]Steps:   0%|          | 13/8880 [05:16<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.353]Steps:   0%|          | 13/8880 [05:18<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.241]Steps:   0%|          | 13/8880 [05:19<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0834]Steps:   0%|          | 13/8880 [05:21<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.296] Sbefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6before downsample: 
torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
teps:   0%|          | 13/8880 [05:22<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.116]Steps:   0%|          | 13/8880 [05:23<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.122]Steps:   0%|          | 13/8880 [05:24<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0872]Steps:   0%|          | 13/8880 [05:26<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0595]Steps:   0%|          | 13/8880 [05:27<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.391] Steps:   0%|          | 13/8880 [05:28<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0477]Steps:   0%|          | 13/8880 [05:30<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0359]Steps:   0%|          | 13/8880 [05:31<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.125] Steps:   0%|          | 13/8880 [05:32<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0952]Steps:   0%|          | 13/8880 [05:34<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0766]Steps:   0%|          | 14/8880 [05:35<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0766]Steps:   0%|          | 14/8880 [05:35<53:47:51,before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet:emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3])  torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3])1 6
 torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
emb torch.Size([1, 320]) torch.Size([1, 96])
1 6
emb torch.Size([1, 1280])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet:emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet:emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
1 6
emb embtorch.Size([1, 320]) torch.Size([1, 96])
 torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 21.84s/it, lr=0.0001, step_loss=0.11]  Steps:   0%|          | 14/8880 [05:37<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.138]Steps:   0%|          | 14/8880 [05:38<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.096]Steps:   0%|          | 14/8880 [05:39<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.169]Steps:   0%|          | 14/8880 [05:40<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.211]Steps:   0%|          | 14/8880 [05:42<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0803]Steps:   0%|          | 14/8880 [05:43<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.051] Steps:   0%|          | 14/8880 [05:45<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.385]Steps:   0%|          | 14/8880 [05:46<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.368]Steps:   0%|          | 14/8880 [05:47<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.417]Steps:   0%|          | 14/8880 [05:48<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0411]Steps:   0%|          | 14/8880 [05:50<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0937]Steps:   0%before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet:1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280]) 
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before downsample:1 6
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
|          | 14/8880 [05:51<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0668]Steps:   0%|          | 14/8880 [05:52<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.522] Steps:   0%|          | 14/8880 [05:54<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.375]Steps:   0%|          | 14/8880 [05:55<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.119]Steps:   0%|          | 15/8880 [05:57<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.119]Steps:   0%|          | 15/8880 [05:57<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.504]Steps:   0%|          | 15/8880 [05:58<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.678]Steps:   0%|          | 15/8880 [05:59<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.133]Steps:   0%|          | 15/8880 [06:01<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.229]Steps:   0%|          | 15/8880 [06:02<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.0614]Steps:   0%|          | 15/8880 [06:03<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.376] Steps:   0%|          | 15/8880 [06:05<53:27:56, 21.71s/it, lr=before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
embemb torch.Size([1, 320]) torch.Size([1, 96])
 emb torch.Size([1, 1280])
torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
0.0001, step_loss=0.077]Steps:   0%|          | 15/8880 [06:06<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.514]Steps:   0%|          | 15/8880 [06:07<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.0966]Steps:   0%|          | 15/8880 [06:09<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.139] Steps:   0%|          | 15/8880 [06:10<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.0499]Steps:   0%|          | 15/8880 [06:11<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.941] Steps:   0%|          | 15/8880 [06:13<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.0864]Steps:   0%|          | 15/8880 [06:14<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.206] Steps:   0%|          | 15/8880 [06:15<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.117]Steps:   0%|          | 15/8880 [06:17<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.16] Steps:   0%|          | 16/8880 [06:18<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.16]Steps:   0%|          | 16/8880 [06:18<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.29]Steps:   0%|          | 16/before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet:emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3])before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
8880 [06:20<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.0568]Steps:   0%|          | 16/8880 [06:21<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.101] Steps:   0%|          | 16/8880 [06:22<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.092]Steps:   0%|          | 16/8880 [06:24<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.354]Steps:   0%|          | 16/8880 [06:25<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.0955]Steps:   0%|          | 16/8880 [06:26<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.162] Steps:   0%|          | 16/8880 [06:28<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.079]Steps:   0%|          | 16/8880 [06:29<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.209]Steps:   0%|          | 16/8880 [06:30<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.0442]Steps:   0%|          | 16/8880 [06:32<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.646] Steps:   0%|          | 16/8880 [06:33<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.481]Steps:   0%|          | 16/8880 [06:34<53:27:24, 21.71s/it, lr=0.0001, step_lbefore controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet:emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
torch.Size([6, 320, 64, 64])1 6
 emb torch.Size([1, 320]) torch.Size([1, 96])
torch.Size([6, 1280]) emb torch.Size([1, 1280])
torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb before controlnet:torch.Size([1, 1280]) 
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])

emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
oss=0.118]Steps:   0%|          | 16/8880 [06:36<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.132]Steps:   0%|          | 16/8880 [06:37<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.41] Steps:   0%|          | 16/8880 [06:38<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.0691]Steps:   0%|          | 17/8880 [06:40<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0691]Steps:   0%|          | 17/8880 [06:40<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.116] Steps:   0%|          | 17/8880 [06:41<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0577]Steps:   0%|          | 17/8880 [06:42<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.295] Steps:   0%|          | 17/8880 [06:44<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.131]Steps:   0%|          | 17/8880 [06:45<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0802]Steps:   0%|          | 17/8880 [06:46<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.286] Steps:   0%|          | 17/8880 [06:48<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.438]Steps:   0%|          | 17/8880 [06:49before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512])before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
emb torch.Size([1, 1280])
1 6
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])

emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before downsample: torch.Size([6, 320, 64, 64])1 6
 torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1])before downsample:  torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.202]Steps:   0%|          | 17/8880 [06:50<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0734]Steps:   0%|          | 17/8880 [06:52<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.257] Steps:   0%|          | 17/8880 [06:53<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.324]Steps:   0%|          | 17/8880 [06:54<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0653]Steps:   0%|          | 17/8880 [06:56<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0671]Steps:   0%|          | 17/8880 [06:57<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0502]Steps:   0%|          | 17/8880 [06:58<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0524]Steps:   0%|          | 17/8880 [07:00<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.183] Steps:   0%|          | 18/8880 [07:01<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.183]Steps:   0%|          | 18/8880 [07:01<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.161]Steps:   0%|          | 18/8880 [07:03<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.167]before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet:before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
emb1 6
 torch.Size([1, 1280])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])

1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
embemb torch.Size([1, 1280])
 torch.Size([1, 320]) torch.Size([1, 96])
embbefore downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
Steps:   0%|          | 18/8880 [07:04<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.129]Steps:   0%|          | 18/8880 [07:05<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.112]Steps:   0%|          | 18/8880 [07:07<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.102]Steps:   0%|          | 18/8880 [07:08<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.182]Steps:   0%|          | 18/8880 [07:09<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.302]Steps:   0%|          | 18/8880 [07:11<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.407]Steps:   0%|          | 18/8880 [07:12<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.117]Steps:   0%|          | 18/8880 [07:14<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.139]Steps:   0%|          | 18/8880 [07:15<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.491]Steps:   0%|          | 18/8880 [07:16<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.0916]Steps:   0%|          | 18/8880 [07:18<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.0742]Steps:   0%|          | 18/8880 [07:19<53:09:01, 21.5before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) before downsample: torch.Size([1])torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
 torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
9s/it, lr=0.0001, step_loss=0.114] Steps:   0%|          | 18/8880 [07:20<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.362]Steps:   0%|          | 18/8880 [07:22<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.081]Steps:   0%|          | 19/8880 [07:23<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.081]Steps:   0%|          | 19/8880 [07:23<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0966]Steps:   0%|          | 19/8880 [07:24<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0714]Steps:   0%|          | 19/8880 [07:26<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0657]Steps:   0%|          | 19/8880 [07:27<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0979]Steps:   0%|          | 19/8880 [07:28<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0738]Steps:   0%|          | 19/8880 [07:30<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.111] Steps:   0%|          | 19/8880 [07:31<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.186]Steps:   0%|          | 19/8880 [07:32<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0414]Steps:   0%| before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
5 6
5 6
5 6
5 6
         | 19/8880 [07:34<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.213] Steps:   0%|          | 19/8880 [07:35<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0626]Steps:   0%|          | 19/8880 [07:36<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0703]Steps:   0%|          | 19/8880 [07:38<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.129] Steps:   0%|          | 19/8880 [07:39<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.219]Steps:   0%|          | 19/8880 [07:40<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.198]Steps:   0%|          | 19/8880 [07:42<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.202]Steps:   0%|          | 19/8880 [07:43<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.274]Steps:   0%|          | 20/8880 [07:45<53:09:15, 21.60s/it, lr=0.0001, step_loss=0.274]Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
    test_loss = evaluate_on_test_set(
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
    down_block_res_samples, mid_block_res_sample = controlnet(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
    return model_forward(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
    timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
AttributeError: 'NoneType' object has no attribute 'view'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
[rank0]:     main()
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
[rank0]:     test_loss = evaluate_on_test_set(
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
[rank0]:     down_block_res_samples, mid_block_res_sample = controlnet(
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
[rank0]:     return model_forward(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
[rank0]:     return convert_to_fp32(self.model_forward(*args, **kwargs))
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
[rank0]:     timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
[rank0]: AttributeError: 'NoneType' object has no attribute 'view'
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
    test_loss = evaluate_on_test_set(
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
    down_block_res_samples, mid_block_res_sample = controlnet(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
    return model_forward(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
    timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
AttributeError: 'NoneType' object has no attribute 'view'
[rank3]: Traceback (most recent call last):
[rank3]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
[rank3]:     main()
[rank3]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
[rank3]:     test_loss = evaluate_on_test_set(
[rank3]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
[rank3]:     down_block_res_samples, mid_block_res_sample = controlnet(
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank3]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank3]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
[rank3]:     return model_forward(*args, **kwargs)
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
[rank3]:     return convert_to_fp32(self.model_forward(*args, **kwargs))
[rank3]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
[rank3]:     return func(*args, **kwargs)
[rank3]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
[rank3]:     timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
[rank3]: AttributeError: 'NoneType' object has no attribute 'view'
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
    test_loss = evaluate_on_test_set(
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
    down_block_res_samples, mid_block_res_sample = controlnet(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
    return model_forward(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
    timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
AttributeError: 'NoneType' object has no attribute 'view'
[rank2]: Traceback (most recent call last):
[rank2]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
[rank2]:     main()
[rank2]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
[rank2]:     test_loss = evaluate_on_test_set(
[rank2]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
[rank2]:     down_block_res_samples, mid_block_res_sample = controlnet(
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank2]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank2]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
[rank2]:     return model_forward(*args, **kwargs)
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
[rank2]:     return convert_to_fp32(self.model_forward(*args, **kwargs))
[rank2]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
[rank2]:     return func(*args, **kwargs)
[rank2]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
[rank2]:     timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
[rank2]: AttributeError: 'NoneType' object has no attribute 'view'
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
    test_loss = evaluate_on_test_set(
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
    down_block_res_samples, mid_block_res_sample = controlnet(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
    return model_forward(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
    timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
AttributeError: 'NoneType' object has no attribute 'view'
[rank1]: Traceback (most recent call last):
[rank1]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
[rank1]:     main()
[rank1]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
[rank1]:     test_loss = evaluate_on_test_set(
[rank1]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
[rank1]:     down_block_res_samples, mid_block_res_sample = controlnet(
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank1]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank1]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
[rank1]:     return model_forward(*args, **kwargs)
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
[rank1]:     return convert_to_fp32(self.model_forward(*args, **kwargs))
[rank1]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
[rank1]:     return func(*args, **kwargs)
[rank1]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
[rank1]:     timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
[rank1]: AttributeError: 'NoneType' object has no attribute 'view'
W1211 02:39:09.881685 140611984176128 torch/distributed/elastic/multiprocessing/api.py:858] Sending process 1849881 closing signal SIGTERM
W1211 02:39:09.882085 140611984176128 torch/distributed/elastic/multiprocessing/api.py:858] Sending process 1849882 closing signal SIGTERM
W1211 02:39:09.882163 140611984176128 torch/distributed/elastic/multiprocessing/api.py:858] Sending process 1849884 closing signal SIGTERM
E1211 02:39:10.296413 140611984176128 torch/distributed/elastic/multiprocessing/api.py:833] failed (exitcode: 1) local_rank: 2 (pid: 1849883) of binary: /fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/bin/python
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 48, in main
    args.func(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 1097, in launch_command
    multi_gpu_launcher(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/commands/launch.py", line 734, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/run.py", line 892, in run
    elastic_launch(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 133, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train_svd_controlnet.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-12-11_02:39:09
  host      : gammagpu11.umiacs.umd.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1849883)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
srun: error: gammagpu11: task 1: Exited with exit code 1
