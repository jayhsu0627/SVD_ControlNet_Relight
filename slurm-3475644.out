NODELIST=gammagpu10
MASTER_ADDR=gammagpu10
Some weights of the model checkpoint were not used when initializing ControlNetSDVModel: 
 ['time_embedding.cond_proj.weight']
Keyword arguments {'text_encoder': CLIPTextModel(
  (text_model): CLIPTextTransformer(
    (embeddings): CLIPTextEmbeddings(
      (token_embedding): Embedding(49408, 1024)
      (position_embedding): Embedding(77, 1024)
    )
    (encoder): CLIPEncoder(
      (layers): ModuleList(
        (0-22): 23 x CLIPEncoderLayer(
          (self_attn): CLIPSdpaAttention(
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (layer_norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (mlp): CLIPMLP(
            (activation_fn): GELUActivation()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          )
          (layer_norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
    (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
  )
)} are not expected by StableVideoDiffusionPipelineControlNet and will be ignored.
Loading existing controlnet weights
layers per block is 2
Loading existing vae weights
***** Running training *****
  Num Epochs = 100
  Instantaneous batch size per device = 1
  Gradient Accumulation steps = 1
  Total optimization steps = None
Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 229.58it/s]
Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]Loading pipeline components...:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:00<00:00, 14.91it/s]Loading pipeline components...:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:00<00:00, 13.32it/s]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 14.70it/s]
0
/fs/nexus-scratch/sjxu/controlnet-diffusers-relighting/exemplars/001
15
15
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
Diffusion steps...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  6.87it/s][A
                                                                 [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  6.84it/s]Marigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  6.83it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.83it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.88it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.90it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.91it/s]
(512, 1024, 3) (512, 1024, 1)
num 5
num 5
/fs/nexus-scratch/sjxu/svd-temporal-controlnet/output/001
torch.Size([5, 1, 16])
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
1
/fs/nexus-scratch/sjxu/controlnet-diffusers-relighting/exemplars/002
5
5
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.94it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.82it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.77it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.78it/s]
(512, 1024, 3) (512, 1024, 1)
Marigold predictions...:   0%|          | 0/1 [00:00<?, ?it/s]
Diffusion steps...:   0%|          | 0/1 [00:00<?, ?it/s][A
                                                         [AMarigold predictions...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13.78it/s]
(512, 1024, 3) (512, 1024, 1)
num 5
num 10
/fs/nexus-scratch/sjxu/svd-temporal-controlnet/output/002
torch.Size([5, 1, 16])
torch.Size([2, 5, 4, 64, 128]) torch.Size([2, 5, 4, 64, 128])
2 5
Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/eval_svd_controlnet.py", line 1003, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/eval_svd_controlnet.py", line 980, in main
    video_frames = pipeline(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/pipeline/pipeline_stable_video_diffusion_controlnet.py", line 546, in __call__
    down_block_res_samples, mid_block_res_sample = self.controlnet(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 539, in forward
    sample = sample + controlnet_cond
RuntimeError: The size of tensor a (10) must match the size of tensor b (20) at non-singleton dimension 0
srun: error: gammagpu10: task 0: Exited with exit code 1
