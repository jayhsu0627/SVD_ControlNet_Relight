11/28/2024 15:44:08 - INFO - __main__ - ***** Running training *****
11/28/2024 15:44:08 - INFO - __main__ -   Num examples = 4728
11/28/2024 15:44:08 - INFO - __main__ -   Num Epochs = 30
11/28/2024 15:44:08 - INFO - __main__ -   Instantaneous batch size per device = 2
11/28/2024 15:44:08 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
11/28/2024 15:44:08 - INFO - __main__ -   Gradient Accumulation steps = 8
11/28/2024 15:44:08 - INFO - __main__ -   Total optimization steps = 2220
Steps:   0%|          | 0/2220 [00:00<?, ?it/s]/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]





Steps:   0%|          | 1/2220 [00:42<26:24:09, 42.83s/it, lr=0.0001, step_loss=0.135]11/28/2024 15:44:51 - INFO - __main__ - Running validation...
 Generating 1 videos.
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 280.71it/s]
Steps:   0%|          | 1/2220 [01:03<26:24:09, 42.83s/it, lr=0.0001, step_loss=0.0932]/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]













































































































































Steps:   1%|          | 20/2220 [05:57<9:24:56, 15.41s/it, lr=0.0001, step_loss=0.13]/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
11/28/2024 15:51:38 - INFO - __main__ - Step 20: Test Loss = 0.1744




















































































































































Steps:   2%|▏         | 40/2220 [12:38<9:21:42, 15.46s/it, lr=0.0001, step_loss=0.457]11/28/2024 15:58:19 - INFO - __main__ - Step 40: Test Loss = 0.1864























































































































































Steps:   3%|▎         | 60/2220 [19:20<9:16:53, 15.47s/it, lr=0.0001, step_loss=0.609]11/28/2024 16:05:01 - INFO - __main__ - Step 60: Test Loss = 0.2184





















































































































































Steps:   4%|▎         | 80/2220 [26:20<9:54:24, 16.67s/it, lr=0.0001, step_loss=0.25] 11/28/2024 16:11:58 - INFO - __main__ - Step 80: Test Loss = 0.1910


























































































































































Steps:   5%|▍         | 100/2220 [32:59<9:06:42, 15.47s/it, lr=0.0001, step_loss=0.0626]11/28/2024 16:18:40 - INFO - __main__ - Step 100: Test Loss = 0.1894





















































































































































Steps:   5%|▌         | 120/2220 [39:41<9:04:57, 15.57s/it, lr=0.0001, step_loss=0.357]11/28/2024 16:25:22 - INFO - __main__ - Step 120: Test Loss = 0.1859

























































































































































Steps:   6%|▋         | 140/2220 [46:23<8:58:24, 15.53s/it, lr=0.0001, step_loss=0.106]11/28/2024 16:32:03 - INFO - __main__ - Step 140: Test Loss = 0.2027




















































































































































Steps:   7%|▋         | 160/2220 [53:21<8:55:07, 15.59s/it, lr=0.0001, step_loss=0.128]11/28/2024 16:39:02 - INFO - __main__ - Step 160: Test Loss = 0.1645

























































































































































Steps:   8%|▊         | 180/2220 [1:00:02<8:45:38, 15.46s/it, lr=0.0001, step_loss=0.129]11/28/2024 16:45:43 - INFO - __main__ - Step 180: Test Loss = 0.1858






















































































































































Steps:   9%|▉         | 200/2220 [1:06:45<8:43:36, 15.55s/it, lr=0.0001, step_loss=0.152]11/28/2024 16:52:24 - INFO - __main__ - Step 200: Test Loss = 0.1735
11/28/2024 16:52:24 - INFO - __main__ - Running validation...
 Generating 1 videos.
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 153.97it/s]




















































































































































Steps:  10%|▉         | 220/2220 [1:13:40<8:33:28, 15.40s/it, lr=0.0001, step_loss=0.449]11/28/2024 16:59:19 - INFO - __main__ - Step 220: Test Loss = 0.1921






















































































































































Steps:  11%|█         | 240/2220 [1:20:39<8:31:55, 15.51s/it, lr=0.0001, step_loss=0.292]11/28/2024 17:06:19 - INFO - __main__ - Step 240: Test Loss = 0.1650
























































































































































Steps:  12%|█▏        | 260/2220 [1:27:20<8:26:44, 15.51s/it, lr=0.0001, step_loss=0.546]11/28/2024 17:12:59 - INFO - __main__ - Step 260: Test Loss = 0.1843

























































































































































Steps:  13%|█▎        | 280/2220 [1:34:01<8:21:37, 15.51s/it, lr=0.0001, step_loss=0.103]11/28/2024 17:19:41 - INFO - __main__ - Step 280: Test Loss = 0.1803






















































































































































Steps:  14%|█▎        | 300/2220 [1:41:01<9:27:25, 17.73s/it, lr=0.0001, step_loss=0.259]11/28/2024 17:26:41 - INFO - __main__ - Step 300: Test Loss = 0.1899





















































































































































Steps:  14%|█▍        | 320/2220 [1:47:43<8:11:17, 15.51s/it, lr=0.0001, step_loss=0.131]11/28/2024 17:33:24 - INFO - __main__ - Step 320: Test Loss = 0.1926





















































































































































Steps:  15%|█▌        | 340/2220 [1:54:26<8:09:25, 15.62s/it, lr=0.0001, step_loss=0.209]11/28/2024 17:40:06 - INFO - __main__ - Step 340: Test Loss = 0.2080
























































































































































Steps:  16%|█▌        | 360/2220 [2:01:08<8:03:06, 15.58s/it, lr=0.0001, step_loss=0.143]11/28/2024 17:46:48 - INFO - __main__ - Step 360: Test Loss = 0.1650





















































































































































Steps:  17%|█▋        | 380/2220 [2:08:07<8:03:32, 15.77s/it, lr=0.0001, step_loss=0.0966]11/28/2024 17:53:47 - INFO - __main__ - Step 380: Test Loss = 0.1669






















































































































































Steps:  18%|█▊        | 400/2220 [2:14:49<7:55:42, 15.68s/it, lr=0.0001, step_loss=0.301]11/28/2024 18:00:28 - INFO - __main__ - Step 400: Test Loss = 0.1735
11/28/2024 18:00:28 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 212.11it/s]























































































































































Steps:  19%|█▉        | 420/2220 [2:21:45<7:46:17, 15.54s/it, lr=0.0001, step_loss=0.194]11/28/2024 18:07:25 - INFO - __main__ - Step 420: Test Loss = 0.1828























































































































































Steps:  20%|█▉        | 440/2220 [2:28:28<7:41:45, 15.56s/it, lr=0.0001, step_loss=0.193]11/28/2024 18:14:07 - INFO - __main__ - Step 440: Test Loss = 0.2039




















































































































































Steps:  21%|██        | 460/2220 [2:35:27<7:36:59, 15.58s/it, lr=0.0001, step_loss=0.155]11/28/2024 18:21:07 - INFO - __main__ - Step 460: Test Loss = 0.1769























































































































































Steps:  22%|██▏       | 480/2220 [2:42:10<7:31:10, 15.56s/it, lr=0.0001, step_loss=0.186]11/28/2024 18:27:50 - INFO - __main__ - Step 480: Test Loss = 0.2092

























































































































































Steps:  23%|██▎       | 500/2220 [2:48:53<7:28:46, 15.66s/it, lr=0.0001, step_loss=0.307]11/28/2024 18:34:33 - INFO - __main__ - Step 500: Test Loss = 0.1991
11/28/2024 18:34:33 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/28/2024 18:34:33 - INFO - __main__ - removing checkpoints: checkpoint-7000
11/28/2024 18:34:33 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/diffusion_pytorch_model.safetensors
11/28/2024 18:34:59 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/optimizer.bin
11/28/2024 18:34:59 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/scheduler.bin
11/28/2024 18:34:59 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/sampler.bin
11/28/2024 18:34:59 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/scaler.pt
11/28/2024 18:34:59 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/random_states_0.pkl
11/28/2024 18:34:59 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500





















































































































































Steps:  23%|██▎       | 520/2220 [2:56:17<9:24:52, 19.94s/it, lr=0.0001, step_loss=0.357] 11/28/2024 18:41:57 - INFO - __main__ - Step 520: Test Loss = 0.1737






















































































































































Steps:  24%|██▍       | 540/2220 [3:02:58<7:13:45, 15.49s/it, lr=0.0001, step_loss=0.212]11/28/2024 18:48:38 - INFO - __main__ - Step 540: Test Loss = 0.1942























































































































































Steps:  25%|██▌       | 560/2220 [3:09:41<7:11:12, 15.59s/it, lr=0.0001, step_loss=0.115]11/28/2024 18:55:20 - INFO - __main__ - Step 560: Test Loss = 0.1758



























































































































































Steps:  26%|██▌       | 580/2220 [3:16:23<7:03:27, 15.49s/it, lr=0.0001, step_loss=0.22]11/28/2024 19:02:02 - INFO - __main__ - Step 580: Test Loss = 0.1747






















































































































































Steps:  27%|██▋       | 600/2220 [3:23:22<7:11:52, 16.00s/it, lr=0.0001, step_loss=0.189]11/28/2024 19:09:02 - INFO - __main__ - Step 600: Test Loss = 0.1924
11/28/2024 19:09:02 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 481.15it/s]




















































































































































Steps:  28%|██▊       | 620/2220 [3:30:18<6:55:17, 15.57s/it, lr=0.0001, step_loss=0.165]11/28/2024 19:15:59 - INFO - __main__ - Step 620: Test Loss = 0.1932






















































































































































Steps:  29%|██▉       | 640/2220 [3:36:59<6:50:35, 15.59s/it, lr=0.0001, step_loss=0.156]11/28/2024 19:22:40 - INFO - __main__ - Step 640: Test Loss = 0.1776























































































































































Steps:  30%|██▉       | 660/2220 [3:43:40<6:42:09, 15.47s/it, lr=0.0001, step_loss=0.303]11/28/2024 19:29:19 - INFO - __main__ - Step 660: Test Loss = 0.1774




















































































































































Steps:  31%|███       | 680/2220 [3:50:40<6:40:56, 15.62s/it, lr=0.0001, step_loss=0.119]11/28/2024 19:36:20 - INFO - __main__ - Step 680: Test Loss = 0.1996






















































































































































Steps:  32%|███▏      | 700/2220 [3:57:21<6:34:18, 15.56s/it, lr=0.0001, step_loss=0.232]11/28/2024 19:43:02 - INFO - __main__ - Step 700: Test Loss = 0.1903






















































































































































Steps:  32%|███▏      | 720/2220 [4:04:04<6:30:42, 15.63s/it, lr=0.0001, step_loss=0.303]11/28/2024 19:49:44 - INFO - __main__ - Step 720: Test Loss = 0.1582



















































































































































Steps:  33%|███▎      | 740/2220 [4:10:39<5:37:54, 13.70s/it, lr=0.0001, step_loss=0.253]11/28/2024 19:56:18 - INFO - __main__ - Step 740: Test Loss = 0.2000





















































































































































Steps:  34%|███▍      | 760/2220 [4:17:45<6:18:03, 15.54s/it, lr=0.0001, step_loss=0.134]11/28/2024 20:03:25 - INFO - __main__ - Step 760: Test Loss = 0.1901























































































































































Steps:  35%|███▌      | 780/2220 [4:24:26<6:11:41, 15.49s/it, lr=0.0001, step_loss=0.0634]11/28/2024 20:10:06 - INFO - __main__ - Step 780: Test Loss = 0.1848






















































































































































Steps:  36%|███▌      | 800/2220 [4:31:07<6:06:38, 15.49s/it, lr=0.0001, step_loss=0.284]11/28/2024 20:16:46 - INFO - __main__ - Step 800: Test Loss = 0.1785
11/28/2024 20:16:46 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 175.96it/s]






















































































































































Steps:  37%|███▋      | 820/2220 [4:38:20<6:28:46, 16.66s/it, lr=0.0001, step_loss=0.197]11/28/2024 20:23:59 - INFO - __main__ - Step 820: Test Loss = 0.1770

























































































































































Steps:  38%|███▊      | 840/2220 [4:45:02<5:57:16, 15.53s/it, lr=0.0001, step_loss=0.232]11/28/2024 20:30:42 - INFO - __main__ - Step 840: Test Loss = 0.1736
























































































































































