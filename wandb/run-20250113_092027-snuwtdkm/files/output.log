INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 4728
INFO:__main__:  Num Epochs = 120
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 64
INFO:__main__:  Gradient Accumulation steps = 16
INFO:__main__:  Total optimization steps = 8880









Steps:   0%|          | 1/8880 [00:29<73:19:42, 29.73s/it, lr=0.0001, step_loss=0.143]INFO:__main__:Running validation...
 Generating 1 videos.
{'insert_light', 'multi_frame', 'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     {'final_sigmas_type', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 298.15it/s]




























































































































































































































































































































































































































































































Steps:   1%|          | 50/8880 [16:38<47:37:49, 19.42s/it, lr=0.0001, step_loss=0.164]Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 2018, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1772, in main
    test_loss = evaluate_on_test_set(
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1378, in evaluate_on_test_set
    conditional_pixel_values = torch.randn_like(conditional_pixel_values) * cond_sigmas + conditional_pixel_values
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 2018, in <module>
[rank0]:     main()
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1772, in main
[rank0]:     test_loss = evaluate_on_test_set(
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1378, in evaluate_on_test_set
[rank0]:     conditional_pixel_values = torch.randn_like(conditional_pixel_values) * cond_sigmas + conditional_pixel_values
[rank0]: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!