INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 4728
INFO:__main__:  Num Epochs = 120
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 64
INFO:__main__:  Gradient Accumulation steps = 16
INFO:__main__:  Total optimization steps = 8880
Steps:   0%|          | 0/8880 [00:00<?, ?it/s]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:11<?, ?it/s, lr=0.0001, step_loss=0.993]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:12<?, ?it/s, lr=0.0001, step_loss=0.163]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:15<?, ?it/s, lr=0.0001, step_loss=0.201]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:17<?, ?it/s, lr=0.0001, step_loss=0.121]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:18<?, ?it/s, lr=0.0001, step_loss=0.118]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:21<?, ?it/s, lr=0.0001, step_loss=0.769]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:22<?, ?it/s, lr=0.0001, step_loss=0.102]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:25<?, ?it/s, lr=0.0001, step_loss=0.105]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:26<?, ?it/s, lr=0.0001, step_loss=0.193]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 0/8880 [00:29<?, ?it/s, lr=0.0001, step_loss=0.259]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])

Steps:   0%|          | 0/8880 [00:30<?, ?it/s, lr=0.0001, step_loss=0.275]
Steps:   0%|          | 1/8880 [00:32<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.275]INFO:__main__:Running validation...
 Generating 1 videos.
{'insert_light', 'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'final_sigmas_type', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 282.33it/s]
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
(512, 512, 3) (512, 512, 1)
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
2 6
emb torch.Size([2, 320]) torch.Size([1, 96])
emb torch.Size([2, 1280])
before downsample: torch.Size([12, 320, 64, 64]) torch.Size([12, 1280]) torch.Size([12, 1, 1024])
Steps:   0%|          | 1/8880 [00:53<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.136]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [00:55<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.17]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [00:56<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.152]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [00:59<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.202]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [01:00<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.0957]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [01:03<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.335]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [01:04<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.118]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [01:07<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.49]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [01:08<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.208]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [01:11<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.198]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 1/8880 [01:12<81:04:24, 32.87s/it, lr=0.0001, step_loss=0.082]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:15<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.551]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:17<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0966]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:20<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.488]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:21<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.222]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:24<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0968]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:25<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.206]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:26<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0742]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:29<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.152]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:30<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.427]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:33<94:00:39, 38.12s/it, lr=0.0001, step_loss=1]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 2/8880 [01:34<94:00:39, 38.12s/it, lr=0.0001, step_loss=0.0873]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:37<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0822]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:39<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.138]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:41<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.384]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:43<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.846]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:45<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0681]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:47<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0446]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:49<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.151]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:51<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.0451]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 3/8880 [01:54<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.238]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])

Steps:   0%|          | 3/8880 [01:55<75:41:26, 30.70s/it, lr=0.0001, step_loss=0.083]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [01:58<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.138]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [01:59<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0858]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:02<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0967]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:03<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.24]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:06<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0865]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:07<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0956]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:08<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0872]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:11<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.0814]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:14<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.171]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:15<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.235]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 4/8880 [02:18<66:58:54, 27.17s/it, lr=0.0001, step_loss=0.185]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:20<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.115]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:21<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.577]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:24<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.623]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:25<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.131]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:27<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0748]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:29<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0848]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:31<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.213]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:33<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0868]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:35<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0719]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6

Steps:   0%|          | 5/8880 [02:37<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.117]
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 5/8880 [02:39<62:09:12, 25.21s/it, lr=0.0001, step_loss=0.0509]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:41<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.337]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:42<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.198]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:45<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.326]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:47<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.0567]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:49<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.067]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:52<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.152]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:53<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.135]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:56<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.183]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:57<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.133]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [02:59<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.704]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 6/8880 [03:02<59:06:26, 23.98s/it, lr=0.0001, step_loss=0.0599]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:03<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.212]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:06<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.141]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:07<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.278]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:08<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.115]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:11<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.161]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:13<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.865]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:15<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.0558]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:17<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.0683]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:19<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.284]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:21<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.168]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 7/8880 [03:23<57:28:22, 23.32s/it, lr=0.0001, step_loss=0.117]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:25<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0604]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:27<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.136]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:29<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.238]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:32<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.797]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:33<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0736]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:36<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.158]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:37<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.991]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:40<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.122]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:41<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0423]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:43<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.0946]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 8/8880 [03:45<56:15:01, 22.82s/it, lr=0.0001, step_loss=0.195]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [03:48<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.336]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [03:49<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0671]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [03:52<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.132]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [03:53<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.118]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [03:56<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0579]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [03:57<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0882]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [04:00<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.159]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [04:01<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.222]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [04:04<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.0787]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [04:05<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.102]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 9/8880 [04:07<55:14:38, 22.42s/it, lr=0.0001, step_loss=0.149]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:10<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0665]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:11<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.575]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:14<54:50:58, 22.26s/it, lr=0.0001, step_loss=1]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:15<54:50:58, 22.26s/it, lr=0.0001, step_loss=1.24]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:18<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.226]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:19<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.25]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:22<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0995]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])

Steps:   0%|          | 10/8880 [04:23<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.287]
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:26<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.173]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:27<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0296]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 10/8880 [04:28<54:50:58, 22.26s/it, lr=0.0001, step_loss=0.0723]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:31<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.368]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:33<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.138]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:35<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.263]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:37<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.168]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:39<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.0837]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:41<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.256]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:43<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.195]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:46<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.144]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:47<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.147]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 11/8880 [04:49<54:30:15, 22.12s/it, lr=0.0001, step_loss=0.079]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [04:52<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.242]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [04:53<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.127]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [04:56<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.235]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [04:57<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.0956]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [05:00<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.169]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [05:01<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.163]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [05:04<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.518]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [05:05<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.104]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [05:07<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.0875]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [05:09<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.495]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 12/8880 [05:11<54:05:37, 21.96s/it, lr=0.0001, step_loss=0.14]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:14<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.238]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:15<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.097]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:18<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.241]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:19<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0834]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:22<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.116]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:23<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.122]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:26<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0595]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:27<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.391]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:30<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0359]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:31<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.125]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 13/8880 [05:34<54:17:39, 22.04s/it, lr=0.0001, step_loss=0.0766]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:35<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.11]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:38<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.096]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:39<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.169]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:42<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0803]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:43<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.051]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:46<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.368]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:47<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.417]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:50<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0937]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:51<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.0668]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 14/8880 [05:54<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.375]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])

Steps:   0%|          | 14/8880 [05:55<53:47:51, 21.84s/it, lr=0.0001, step_loss=0.119]
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [05:58<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.678]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [05:59<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.133]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:02<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.0614]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:03<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.376]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:06<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.514]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:07<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.0966]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:10<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.0499]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:11<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.941]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:14<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.206]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:15<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.117]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 15/8880 [06:17<53:27:56, 21.71s/it, lr=0.0001, step_loss=0.16]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:20<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.0568]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:21<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.101]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:24<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.354]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:25<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.0955]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:28<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.079]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:29<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.209]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:32<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.646]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:33<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.481]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:36<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.132]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 16/8880 [06:37<53:27:24, 21.71s/it, lr=0.0001, step_loss=0.41]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:40<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.116]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:41<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0577]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:44<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.131]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:45<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0802]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:48<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.438]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:49<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.202]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:52<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.257]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:53<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.324]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:56<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0671]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [06:57<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.0502]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 17/8880 [07:00<53:10:57, 21.60s/it, lr=0.0001, step_loss=0.183]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:01<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.161]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:04<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.129]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:05<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.112]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:08<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.182]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:09<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.302]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:12<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.117]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:14<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.139]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:16<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.0916]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:18<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.0742]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:20<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.362]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 18/8880 [07:22<53:09:01, 21.59s/it, lr=0.0001, step_loss=0.081]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:24<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0714]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:26<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0657]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:28<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0738]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:30<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.111]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:32<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0414]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:34<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.213]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:36<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.0703]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:38<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.129]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:40<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.198]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])
before downsample: torch.Size([6, 320, 64, 64]) torch.Size([6, 1280]) torch.Size([6, 77, 1024])
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])

Steps:   0%|          | 19/8880 [07:42<53:19:11, 21.66s/it, lr=0.0001, step_loss=0.202]
before controlnet: torch.Size([1, 6, 8, 64, 64]) torch.Size([1]) torch.Size([1, 77, 1024]) torch.Size([1, 3]) torch.Size([1, 6, 4, 512, 512]) torch.Size([1, 6, 1, 16])
1 6
emb torch.Size([1, 320]) torch.Size([1, 96])
emb torch.Size([1, 1280])


Steps:   0%|          | 20/8880 [07:45<53:09:15, 21.60s/it, lr=0.0001, step_loss=0.274]
Steps:   0%|          | 20/8880 [07:45<53:09:15, 21.60s/it, lr=0.0001, step_loss=0.274]Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
    test_loss = evaluate_on_test_set(
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
    down_block_res_samples, mid_block_res_sample = controlnet(
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
    return model_forward(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
    timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
AttributeError: 'NoneType' object has no attribute 'view'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1961, in <module>
[rank0]:     main()
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1719, in main
[rank0]:     test_loss = evaluate_on_test_set(
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1397, in evaluate_on_test_set
[rank0]:     down_block_res_samples, mid_block_res_sample = controlnet(
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 819, in forward
[rank0]:     return model_forward(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/accelerate/utils/operations.py", line 807, in __call__
[rank0]:     return convert_to_fp32(self.model_forward(*args, **kwargs))
[rank0]:   File "/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 43, in decorate_autocast
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/models/controlnet_sdv.py", line 510, in forward
[rank0]:     timestep_cond = timestep_cond.view(timestep_cond.shape[0], -1)
