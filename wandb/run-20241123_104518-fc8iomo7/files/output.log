11/23/2024 10:45:24 - INFO - __main__ - ***** Running training *****
11/23/2024 10:45:24 - INFO - __main__ -   Num examples = 15760
11/23/2024 10:45:24 - INFO - __main__ -   Num Epochs = 30
11/23/2024 10:45:24 - INFO - __main__ -   Instantaneous batch size per device = 2
11/23/2024 10:45:24 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
11/23/2024 10:45:24 - INFO - __main__ -   Gradient Accumulation steps = 8
11/23/2024 10:45:24 - INFO - __main__ -   Total optimization steps = 7410
Steps:   0%|          | 0/7410 [00:00<?, ?it/s]/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]





Steps:   0%|          | 1/7410 [00:37<76:34:16, 37.21s/it, lr=0.0001, step_loss=0.204]11/23/2024 10:46:01 - INFO - __main__ - Running validation...
 Generating 1 videos.
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 275.97it/s]
Steps:   0%|          | 1/7410 [00:55<76:34:16, 37.21s/it, lr=0.0001, step_loss=0.259]/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
  with device_autocast_ctx, torch.cpu.amp.autocast(**cpu_autocast_kwargs), recompute_context:  # type: ignore[attr-defined]






























































































































Steps:   0%|          | 20/7410 [05:11<27:45:12, 13.52s/it, lr=0.0001, step_loss=0.111]/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
11/23/2024 10:51:53 - INFO - __main__ - Step 20: Test Loss = 0.2053






































































































































Steps:   1%|          | 40/7410 [11:00<27:42:06, 13.53s/it, lr=0.0001, step_loss=0.175]11/23/2024 10:57:41 - INFO - __main__ - Step 40: Test Loss = 0.1842







































































































































Steps:   1%|          | 60/7410 [16:48<27:34:27, 13.51s/it, lr=0.0001, step_loss=0.413]11/23/2024 11:03:30 - INFO - __main__ - Step 60: Test Loss = 0.1964







































































































































Steps:   1%|          | 80/7410 [22:37<27:37:02, 13.56s/it, lr=0.0001, step_loss=0.219]11/23/2024 11:09:18 - INFO - __main__ - Step 80: Test Loss = 0.1941






































































































































Steps:   1%|▏         | 100/7410 [28:25<27:49:04, 13.70s/it, lr=0.0001, step_loss=0.132]11/23/2024 11:15:06 - INFO - __main__ - Step 100: Test Loss = 0.1988






































































































































Steps:   2%|▏         | 120/7410 [34:12<27:42:40, 13.68s/it, lr=0.0001, step_loss=0.165]11/23/2024 11:20:53 - INFO - __main__ - Step 120: Test Loss = 0.2031







































































































































Steps:   2%|▏         | 140/7410 [40:00<27:21:21, 13.55s/it, lr=0.0001, step_loss=0.119]11/23/2024 11:26:41 - INFO - __main__ - Step 140: Test Loss = 0.1940







































































































































Steps:   2%|▏         | 160/7410 [45:48<27:11:46, 13.50s/it, lr=0.0001, step_loss=0.179]11/23/2024 11:32:29 - INFO - __main__ - Step 160: Test Loss = 0.1690






































































































































Steps:   2%|▏         | 180/7410 [51:37<27:08:03, 13.51s/it, lr=0.0001, step_loss=0.196]11/23/2024 11:38:18 - INFO - __main__ - Step 180: Test Loss = 0.1731







































































































































Steps:   3%|▎         | 200/7410 [57:26<27:18:59, 13.64s/it, lr=0.0001, step_loss=0.133]11/23/2024 11:44:06 - INFO - __main__ - Step 200: Test Loss = 0.1922
11/23/2024 11:44:06 - INFO - __main__ - Running validation...
 Generating 1 videos.
/fs/nexus-scratch/sjxu/miniconda3/envs/svd_control/lib/python3.9/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 444.93it/s]





































































































































Steps:   3%|▎         | 220/7410 [1:03:26<27:03:20, 13.55s/it, lr=0.0001, step_loss=0.298]11/23/2024 11:50:08 - INFO - __main__ - Step 220: Test Loss = 0.1905






































































































































Steps:   3%|▎         | 240/7410 [1:09:15<27:00:04, 13.56s/it, lr=0.0001, step_loss=0.153]11/23/2024 11:55:55 - INFO - __main__ - Step 240: Test Loss = 0.1899
































































































































Steps:   4%|▎         | 260/7410 [1:15:09<26:56:53, 13.57s/it, lr=0.0001, step_loss=0.311]11/23/2024 12:01:50 - INFO - __main__ - Step 260: Test Loss = 0.1829





































































































































Steps:   4%|▍         | 280/7410 [1:20:56<26:47:37, 13.53s/it, lr=0.0001, step_loss=0.14]11/23/2024 12:07:37 - INFO - __main__ - Step 280: Test Loss = 0.1818






































































































































Steps:   4%|▍         | 300/7410 [1:26:43<26:59:13, 13.66s/it, lr=0.0001, step_loss=0.171]11/23/2024 12:13:23 - INFO - __main__ - Step 300: Test Loss = 0.1891






































































































































Steps:   4%|▍         | 320/7410 [1:32:29<26:36:16, 13.51s/it, lr=0.0001, step_loss=0.0898]11/23/2024 12:19:10 - INFO - __main__ - Step 320: Test Loss = 0.2075






































































































































Steps:   5%|▍         | 340/7410 [1:38:15<26:33:46, 13.53s/it, lr=0.0001, step_loss=0.222]11/23/2024 12:24:56 - INFO - __main__ - Step 340: Test Loss = 0.1784





































































































































Steps:   5%|▍         | 360/7410 [1:44:01<26:15:02, 13.40s/it, lr=0.0001, step_loss=0.346]11/23/2024 12:30:43 - INFO - __main__ - Step 360: Test Loss = 0.1845







































































































































Steps:   5%|▌         | 380/7410 [1:49:49<26:16:24, 13.45s/it, lr=0.0001, step_loss=0.138]11/23/2024 12:36:30 - INFO - __main__ - Step 380: Test Loss = 0.2097







































































































































Steps:   5%|▌         | 400/7410 [1:55:36<26:23:28, 13.55s/it, lr=0.0001, step_loss=0.144]11/23/2024 12:42:17 - INFO - __main__ - Step 400: Test Loss = 0.1987
11/23/2024 12:42:17 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 283.43it/s]







































































































































Steps:   6%|▌         | 420/7410 [2:01:35<26:15:58, 13.53s/it, lr=0.0001, step_loss=0.339]11/23/2024 12:48:16 - INFO - __main__ - Step 420: Test Loss = 0.1851







































































































































Steps:   6%|▌         | 440/7410 [2:07:24<26:19:19, 13.60s/it, lr=0.0001, step_loss=0.18]11/23/2024 12:54:04 - INFO - __main__ - Step 440: Test Loss = 0.1850




































































































































Steps:   6%|▌         | 460/7410 [2:13:10<26:06:44, 13.53s/it, lr=0.0001, step_loss=0.327]11/23/2024 12:59:52 - INFO - __main__ - Step 460: Test Loss = 0.2070






































































































































Steps:   6%|▋         | 480/7410 [2:18:57<25:59:03, 13.50s/it, lr=0.0001, step_loss=0.0924]11/23/2024 13:05:39 - INFO - __main__ - Step 480: Test Loss = 0.1852
































































































































Steps:   7%|▋         | 500/7410 [2:24:52<27:08:40, 14.14s/it, lr=0.0001, step_loss=0.239]11/23/2024 13:11:33 - INFO - __main__ - Step 500: Test Loss = 0.1850
11/23/2024 13:11:33 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/23/2024 13:11:33 - INFO - __main__ - removing checkpoints: checkpoint-2000
11/23/2024 13:11:33 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/controlnet/diffusion_pytorch_model.safetensors
11/23/2024 13:11:59 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/optimizer.bin
11/23/2024 13:11:59 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/scheduler.bin
11/23/2024 13:11:59 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/sampler.bin
11/23/2024 13:11:59 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/scaler.pt
11/23/2024 13:11:59 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500/random_states_0.pkl
11/23/2024 13:11:59 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-500





































































































































Steps:   7%|▋         | 520/7410 [2:31:05<26:03:42, 13.62s/it, lr=0.0001, step_loss=0.132]11/23/2024 13:17:47 - INFO - __main__ - Step 520: Test Loss = 0.1742







































































































































Steps:   7%|▋         | 540/7410 [2:36:53<25:51:46, 13.55s/it, lr=0.0001, step_loss=0.112]11/23/2024 13:23:35 - INFO - __main__ - Step 540: Test Loss = 0.1771







































































































































Steps:   8%|▊         | 560/7410 [2:42:41<25:41:12, 13.50s/it, lr=0.0001, step_loss=0.227]11/23/2024 13:29:21 - INFO - __main__ - Step 560: Test Loss = 0.1801







































































































































Steps:   8%|▊         | 580/7410 [2:48:30<25:47:11, 13.59s/it, lr=0.0001, step_loss=0.176]11/23/2024 13:35:10 - INFO - __main__ - Step 580: Test Loss = 0.2114








































































































































Steps:   8%|▊         | 600/7410 [2:54:17<25:36:10, 13.53s/it, lr=0.0001, step_loss=0.236]11/23/2024 13:40:58 - INFO - __main__ - Step 600: Test Loss = 0.1626
11/23/2024 13:40:58 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 343.46it/s]







































































































































Steps:   8%|▊         | 620/7410 [3:00:17<25:38:02, 13.59s/it, lr=0.0001, step_loss=0.184]11/23/2024 13:46:58 - INFO - __main__ - Step 620: Test Loss = 0.1444






































































































































Steps:   9%|▊         | 640/7410 [3:06:05<25:53:03, 13.76s/it, lr=0.0001, step_loss=0.0965]11/23/2024 13:52:46 - INFO - __main__ - Step 640: Test Loss = 0.2047







































































































































Steps:   9%|▉         | 660/7410 [3:11:53<25:29:27, 13.60s/it, lr=0.0001, step_loss=0.31]11/23/2024 13:58:34 - INFO - __main__ - Step 660: Test Loss = 0.1715







































































































































Steps:   9%|▉         | 680/7410 [3:17:41<25:17:30, 13.53s/it, lr=0.0001, step_loss=0.209]11/23/2024 14:04:22 - INFO - __main__ - Step 680: Test Loss = 0.1771






































































































































Steps:   9%|▉         | 700/7410 [3:23:28<25:07:39, 13.48s/it, lr=0.0001, step_loss=0.0645]11/23/2024 14:10:09 - INFO - __main__ - Step 700: Test Loss = 0.2197



































































































































Steps:  10%|▉         | 720/7410 [3:29:16<25:15:24, 13.59s/it, lr=0.0001, step_loss=0.0588]11/23/2024 14:15:56 - INFO - __main__ - Step 720: Test Loss = 0.1871





































































































































Steps:  10%|▉         | 740/7410 [3:34:59<23:03:44, 12.45s/it, lr=0.0001, step_loss=0.12]11/23/2024 14:21:38 - INFO - __main__ - Step 740: Test Loss = 0.1806



































































































































Steps:  10%|█         | 760/7410 [3:40:57<25:06:39, 13.59s/it, lr=0.0001, step_loss=0.246]11/23/2024 14:27:38 - INFO - __main__ - Step 760: Test Loss = 0.1872






































































































































Steps:  11%|█         | 780/7410 [3:46:42<24:42:49, 13.42s/it, lr=0.0001, step_loss=0.26]11/23/2024 14:33:23 - INFO - __main__ - Step 780: Test Loss = 0.1807







































































































































Steps:  11%|█         | 800/7410 [3:52:28<24:35:42, 13.40s/it, lr=0.0001, step_loss=0.103]11/23/2024 14:39:09 - INFO - __main__ - Step 800: Test Loss = 0.1851
11/23/2024 14:39:09 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 423.42it/s]





































































































































Steps:  11%|█         | 820/7410 [3:58:27<24:47:04, 13.54s/it, lr=0.0001, step_loss=0.142]11/23/2024 14:45:09 - INFO - __main__ - Step 820: Test Loss = 0.1565






































































































































Steps:  11%|█▏        | 840/7410 [4:04:13<24:28:56, 13.42s/it, lr=0.0001, step_loss=0.112]11/23/2024 14:50:54 - INFO - __main__ - Step 840: Test Loss = 0.1851





































































































































Steps:  12%|█▏        | 860/7410 [4:10:00<24:33:08, 13.49s/it, lr=0.0001, step_loss=0.109]11/23/2024 14:56:40 - INFO - __main__ - Step 860: Test Loss = 0.2040







































































































































Steps:  12%|█▏        | 880/7410 [4:15:45<24:23:31, 13.45s/it, lr=0.0001, step_loss=0.268]11/23/2024 15:02:27 - INFO - __main__ - Step 880: Test Loss = 0.1850






































































































































Steps:  12%|█▏        | 900/7410 [4:21:32<24:23:33, 13.49s/it, lr=0.0001, step_loss=0.415]11/23/2024 15:08:10 - INFO - __main__ - Step 900: Test Loss = 0.1860







































































































































Steps:  12%|█▏        | 920/7410 [4:27:18<24:34:58, 13.64s/it, lr=0.0001, step_loss=0.124]11/23/2024 15:13:59 - INFO - __main__ - Step 920: Test Loss = 0.1752







































































































































Steps:  13%|█▎        | 940/7410 [4:33:05<24:17:30, 13.52s/it, lr=0.0001, step_loss=0.133]11/23/2024 15:19:46 - INFO - __main__ - Step 940: Test Loss = 0.1887






































































































































Steps:  13%|█▎        | 960/7410 [4:38:52<24:27:48, 13.65s/it, lr=0.0001, step_loss=0.129]11/23/2024 15:25:33 - INFO - __main__ - Step 960: Test Loss = 0.1887





































































































































Steps:  13%|█▎        | 980/7410 [4:44:37<24:04:56, 13.48s/it, lr=0.0001, step_loss=0.14]11/23/2024 15:31:18 - INFO - __main__ - Step 980: Test Loss = 0.1687
































































































































Steps:  13%|█▎        | 1000/7410 [4:50:30<23:54:34, 13.43s/it, lr=0.0001, step_loss=0.129]11/23/2024 15:37:11 - INFO - __main__ - Step 1000: Test Loss = 0.1740
11/23/2024 15:37:11 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/23/2024 15:37:11 - INFO - __main__ - removing checkpoints: checkpoint-500
11/23/2024 15:37:12 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/controlnet/diffusion_pytorch_model.safetensors
11/23/2024 15:37:37 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/optimizer.bin
11/23/2024 15:37:37 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/scheduler.bin
11/23/2024 15:37:37 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/sampler.bin
11/23/2024 15:37:37 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/scaler.pt
11/23/2024 15:37:37 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000/random_states_0.pkl
11/23/2024 15:37:37 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1000
11/23/2024 15:37:37 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 465.19it/s]






































































































































Steps:  14%|█▍        | 1020/7410 [4:56:55<24:02:01, 13.54s/it, lr=0.0001, step_loss=0.165]11/23/2024 15:43:36 - INFO - __main__ - Step 1020: Test Loss = 0.1878







































































































































Steps:  14%|█▍        | 1040/7410 [5:02:43<24:03:56, 13.60s/it, lr=0.0001, step_loss=0.123]11/23/2024 15:49:24 - INFO - __main__ - Step 1040: Test Loss = 0.1666





































































































































Steps:  14%|█▍        | 1060/7410 [5:08:29<23:56:18, 13.57s/it, lr=0.0001, step_loss=0.179]11/23/2024 15:55:10 - INFO - __main__ - Step 1060: Test Loss = 0.2006






































































































































Steps:  15%|█▍        | 1080/7410 [5:14:16<23:55:29, 13.61s/it, lr=0.0001, step_loss=0.0872]11/23/2024 16:00:56 - INFO - __main__ - Step 1080: Test Loss = 0.1659





































































































































Steps:  15%|█▍        | 1100/7410 [5:20:02<23:28:25, 13.39s/it, lr=0.0001, step_loss=0.501]11/23/2024 16:06:43 - INFO - __main__ - Step 1100: Test Loss = 0.1949





































































































































Steps:  15%|█▌        | 1120/7410 [5:25:49<23:40:26, 13.55s/it, lr=0.0001, step_loss=0.0752]11/23/2024 16:12:30 - INFO - __main__ - Step 1120: Test Loss = 0.1714






































































































































Steps:  15%|█▌        | 1140/7410 [5:31:35<23:27:27, 13.47s/it, lr=0.0001, step_loss=0.0996]11/23/2024 16:18:16 - INFO - __main__ - Step 1140: Test Loss = 0.1848






































































































































Steps:  16%|█▌        | 1160/7410 [5:37:21<23:34:27, 13.58s/it, lr=0.0001, step_loss=0.543]11/23/2024 16:24:02 - INFO - __main__ - Step 1160: Test Loss = 0.2145







































































































































Steps:  16%|█▌        | 1180/7410 [5:43:08<23:25:42, 13.54s/it, lr=0.0001, step_loss=0.122]11/23/2024 16:29:49 - INFO - __main__ - Step 1180: Test Loss = 0.1785







































































































































Steps:  16%|█▌        | 1200/7410 [5:48:55<23:12:43, 13.46s/it, lr=0.0001, step_loss=0.0874]11/23/2024 16:35:37 - INFO - __main__ - Step 1200: Test Loss = 0.1604
11/23/2024 16:35:37 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 306.89it/s]







































































































































Steps:  16%|█▋        | 1220/7410 [5:54:57<23:24:47, 13.62s/it, lr=0.0001, step_loss=0.178]11/23/2024 16:41:38 - INFO - __main__ - Step 1220: Test Loss = 0.1800































































































































Steps:  17%|█▋        | 1240/7410 [6:00:50<24:50:11, 14.49s/it, lr=0.0001, step_loss=0.309]11/23/2024 16:47:30 - INFO - __main__ - Step 1240: Test Loss = 0.1638




































































































































Steps:  17%|█▋        | 1260/7410 [6:06:37<23:18:41, 13.65s/it, lr=0.0001, step_loss=0.185]11/23/2024 16:53:18 - INFO - __main__ - Step 1260: Test Loss = 0.1679





































































































































Steps:  17%|█▋        | 1280/7410 [6:12:24<22:59:57, 13.51s/it, lr=0.0001, step_loss=0.529]11/23/2024 16:59:05 - INFO - __main__ - Step 1280: Test Loss = 0.1782





































































































































Steps:  18%|█▊        | 1300/7410 [6:18:10<22:54:49, 13.50s/it, lr=0.0001, step_loss=0.128]11/23/2024 17:04:51 - INFO - __main__ - Step 1300: Test Loss = 0.1837






































































































































Steps:  18%|█▊        | 1320/7410 [6:23:58<22:52:31, 13.52s/it, lr=0.0001, step_loss=0.268]11/23/2024 17:10:38 - INFO - __main__ - Step 1320: Test Loss = 0.1683






































































































































Steps:  18%|█▊        | 1340/7410 [6:29:45<22:53:03, 13.57s/it, lr=0.0001, step_loss=0.479]11/23/2024 17:16:24 - INFO - __main__ - Step 1340: Test Loss = 0.1793







































































































































Steps:  18%|█▊        | 1360/7410 [6:35:31<22:49:23, 13.58s/it, lr=0.0001, step_loss=0.108]11/23/2024 17:22:12 - INFO - __main__ - Step 1360: Test Loss = 0.1879







































































































































Steps:  19%|█▊        | 1380/7410 [6:41:18<22:46:35, 13.60s/it, lr=0.0001, step_loss=0.0966]11/23/2024 17:27:59 - INFO - __main__ - Step 1380: Test Loss = 0.1571





































































































































Steps:  19%|█▉        | 1400/7410 [6:47:05<22:27:29, 13.45s/it, lr=0.0001, step_loss=0.11]11/23/2024 17:33:45 - INFO - __main__ - Step 1400: Test Loss = 0.1522
11/23/2024 17:33:45 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 356.92it/s]






































































































































Steps:  19%|█▉        | 1420/7410 [6:53:04<22:27:37, 13.50s/it, lr=0.0001, step_loss=0.181]11/23/2024 17:39:44 - INFO - __main__ - Step 1420: Test Loss = 0.1560







































































































































Steps:  19%|█▉        | 1440/7410 [6:58:52<22:39:28, 13.66s/it, lr=0.0001, step_loss=0.115]11/23/2024 17:45:33 - INFO - __main__ - Step 1440: Test Loss = 0.1690





































































































































Steps:  20%|█▉        | 1460/7410 [7:04:40<22:23:43, 13.55s/it, lr=0.0001, step_loss=0.181]11/23/2024 17:51:21 - INFO - __main__ - Step 1460: Test Loss = 0.1734





































































































































Steps:  20%|█▉        | 1480/7410 [7:10:25<21:11:11, 12.86s/it, lr=0.0001, step_loss=0.215]11/23/2024 17:57:06 - INFO - __main__ - Step 1480: Test Loss = 0.1792
































































































































Steps:  20%|██        | 1500/7410 [7:16:20<22:06:40, 13.47s/it, lr=0.0001, step_loss=0.09]11/23/2024 18:03:00 - INFO - __main__ - Step 1500: Test Loss = 0.1648
11/23/2024 18:03:00 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/23/2024 18:03:00 - INFO - __main__ - removing checkpoints: checkpoint-1000
11/23/2024 18:03:01 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/controlnet/diffusion_pytorch_model.safetensors
11/23/2024 18:03:27 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/optimizer.bin
11/23/2024 18:03:27 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/scheduler.bin
11/23/2024 18:03:27 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/sampler.bin
11/23/2024 18:03:27 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/scaler.pt
11/23/2024 18:03:27 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500/random_states_0.pkl
11/23/2024 18:03:27 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-1500





































































































































Steps:  21%|██        | 1520/7410 [7:22:31<21:58:58, 13.44s/it, lr=0.0001, step_loss=0.078]11/23/2024 18:09:12 - INFO - __main__ - Step 1520: Test Loss = 0.1832







































































































































Steps:  21%|██        | 1540/7410 [7:28:18<22:07:37, 13.57s/it, lr=0.0001, step_loss=0.438]11/23/2024 18:14:59 - INFO - __main__ - Step 1540: Test Loss = 0.1621






































































































































Steps:  21%|██        | 1560/7410 [7:34:05<22:00:38, 13.55s/it, lr=0.0001, step_loss=0.46]11/23/2024 18:20:46 - INFO - __main__ - Step 1560: Test Loss = 0.1684





































































































































Steps:  21%|██▏       | 1580/7410 [7:39:52<21:42:20, 13.40s/it, lr=0.0001, step_loss=0.0697]11/23/2024 18:26:33 - INFO - __main__ - Step 1580: Test Loss = 0.1678




































































































































Steps:  22%|██▏       | 1600/7410 [7:45:38<21:43:27, 13.46s/it, lr=0.0001, step_loss=0.124]11/23/2024 18:32:20 - INFO - __main__ - Step 1600: Test Loss = 0.2025
11/23/2024 18:32:20 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 377.46it/s]





































































































































Steps:  22%|██▏       | 1620/7410 [7:51:37<21:47:32, 13.55s/it, lr=0.0001, step_loss=0.389]11/23/2024 18:38:19 - INFO - __main__ - Step 1620: Test Loss = 0.1846







































































































































Steps:  22%|██▏       | 1640/7410 [7:57:25<21:35:17, 13.47s/it, lr=0.0001, step_loss=0.252]11/23/2024 18:44:07 - INFO - __main__ - Step 1640: Test Loss = 0.1791






































































































































Steps:  22%|██▏       | 1660/7410 [8:03:12<21:30:19, 13.46s/it, lr=0.0001, step_loss=0.0725]11/23/2024 18:49:52 - INFO - __main__ - Step 1660: Test Loss = 0.1864






































































































































Steps:  23%|██▎       | 1680/7410 [8:08:58<21:30:32, 13.51s/it, lr=0.0001, step_loss=0.229]11/23/2024 18:55:39 - INFO - __main__ - Step 1680: Test Loss = 0.1634






































































































































Steps:  23%|██▎       | 1700/7410 [8:14:44<21:28:53, 13.54s/it, lr=0.0001, step_loss=0.123]11/23/2024 19:01:26 - INFO - __main__ - Step 1700: Test Loss = 0.1762




































































































































Steps:  23%|██▎       | 1720/7410 [8:20:30<21:18:58, 13.49s/it, lr=0.0001, step_loss=0.172]11/23/2024 19:07:11 - INFO - __main__ - Step 1720: Test Loss = 0.1638































































































































Steps:  23%|██▎       | 1740/7410 [8:26:23<21:28:29, 13.63s/it, lr=0.0001, step_loss=0.193]11/23/2024 19:13:04 - INFO - __main__ - Step 1740: Test Loss = 0.1781






































































































































Steps:  24%|██▍       | 1760/7410 [8:32:10<21:07:05, 13.46s/it, lr=0.0001, step_loss=0.104]11/23/2024 19:18:51 - INFO - __main__ - Step 1760: Test Loss = 0.1477






































































































































Steps:  24%|██▍       | 1780/7410 [8:37:57<21:06:00, 13.49s/it, lr=0.0001, step_loss=0.0759]11/23/2024 19:24:38 - INFO - __main__ - Step 1780: Test Loss = 0.1821





































































































































Steps:  24%|██▍       | 1800/7410 [8:43:45<21:09:47, 13.58s/it, lr=0.0001, step_loss=0.134]11/23/2024 19:30:25 - INFO - __main__ - Step 1800: Test Loss = 0.1617
11/23/2024 19:30:25 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 198.74it/s]







































































































































Steps:  25%|██▍       | 1820/7410 [8:49:43<20:57:16, 13.49s/it, lr=0.0001, step_loss=0.0822]11/23/2024 19:36:24 - INFO - __main__ - Step 1820: Test Loss = 0.1604






































































































































Steps:  25%|██▍       | 1840/7410 [8:55:31<21:00:11, 13.57s/it, lr=0.0001, step_loss=0.202]11/23/2024 19:42:12 - INFO - __main__ - Step 1840: Test Loss = 0.1721







































































































































Steps:  25%|██▌       | 1860/7410 [9:01:19<21:01:19, 13.64s/it, lr=0.0001, step_loss=0.0859]11/23/2024 19:48:00 - INFO - __main__ - Step 1860: Test Loss = 0.1849






































































































































Steps:  25%|██▌       | 1880/7410 [9:07:07<20:48:23, 13.55s/it, lr=0.0001, step_loss=0.0855]11/23/2024 19:53:47 - INFO - __main__ - Step 1880: Test Loss = 0.1979







































































































































Steps:  26%|██▌       | 1900/7410 [9:12:54<20:47:15, 13.58s/it, lr=0.0001, step_loss=0.0608]11/23/2024 19:59:35 - INFO - __main__ - Step 1900: Test Loss = 0.1718






































































































































Steps:  26%|██▌       | 1920/7410 [9:18:41<20:39:53, 13.55s/it, lr=0.0001, step_loss=0.133]11/23/2024 20:05:22 - INFO - __main__ - Step 1920: Test Loss = 0.1853







































































































































Steps:  26%|██▌       | 1940/7410 [9:24:28<20:32:02, 13.51s/it, lr=0.0001, step_loss=0.189]11/23/2024 20:11:09 - INFO - __main__ - Step 1940: Test Loss = 0.2051







































































































































Steps:  26%|██▋       | 1960/7410 [9:30:16<20:30:12, 13.54s/it, lr=0.0001, step_loss=0.199]11/23/2024 20:16:57 - INFO - __main__ - Step 1960: Test Loss = 0.1814
































































































































Steps:  27%|██▋       | 1980/7410 [9:36:09<22:08:46, 14.68s/it, lr=0.0001, step_loss=0.442]11/23/2024 20:22:50 - INFO - __main__ - Step 1980: Test Loss = 0.1782







































































































































Steps:  27%|██▋       | 2000/7410 [9:41:55<20:19:49, 13.53s/it, lr=0.0001, step_loss=0.4]11/23/2024 20:28:35 - INFO - __main__ - Step 2000: Test Loss = 0.1422
11/23/2024 20:28:35 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/23/2024 20:28:35 - INFO - __main__ - removing checkpoints: checkpoint-1500
11/23/2024 20:28:37 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/controlnet/diffusion_pytorch_model.safetensors
11/23/2024 20:29:02 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/optimizer.bin
11/23/2024 20:29:02 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/scheduler.bin
11/23/2024 20:29:02 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/sampler.bin
11/23/2024 20:29:02 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/scaler.pt
11/23/2024 20:29:02 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000/random_states_0.pkl
11/23/2024 20:29:02 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2000
11/23/2024 20:29:02 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 482.47it/s]






































































































































Steps:  27%|██▋       | 2020/7410 [9:48:19<20:14:52, 13.52s/it, lr=0.0001, step_loss=0.0887]11/23/2024 20:35:00 - INFO - __main__ - Step 2020: Test Loss = 0.1651




































































































































Steps:  28%|██▊       | 2040/7410 [9:54:07<20:05:34, 13.47s/it, lr=0.0001, step_loss=0.156]11/23/2024 20:40:48 - INFO - __main__ - Step 2040: Test Loss = 0.1666





































































































































Steps:  28%|██▊       | 2060/7410 [9:59:54<19:56:50, 13.42s/it, lr=0.0001, step_loss=0.105]11/23/2024 20:46:35 - INFO - __main__ - Step 2060: Test Loss = 0.1548







































































































































Steps:  28%|██▊       | 2080/7410 [10:05:41<19:53:39, 13.44s/it, lr=0.0001, step_loss=0.453]11/23/2024 20:52:22 - INFO - __main__ - Step 2080: Test Loss = 0.1767







































































































































Steps:  28%|██▊       | 2100/7410 [10:11:28<19:58:07, 13.54s/it, lr=0.0001, step_loss=0.127]11/23/2024 20:58:09 - INFO - __main__ - Step 2100: Test Loss = 0.1810







































































































































Steps:  29%|██▊       | 2120/7410 [10:17:15<19:54:54, 13.55s/it, lr=0.0001, step_loss=0.0963]11/23/2024 21:03:57 - INFO - __main__ - Step 2120: Test Loss = 0.1708






































































































































Steps:  29%|██▉       | 2140/7410 [10:23:02<19:52:45, 13.58s/it, lr=0.0001, step_loss=0.155]11/23/2024 21:09:44 - INFO - __main__ - Step 2140: Test Loss = 0.1797






































































































































Steps:  29%|██▉       | 2160/7410 [10:28:49<19:36:00, 13.44s/it, lr=0.0001, step_loss=0.146]11/23/2024 21:15:30 - INFO - __main__ - Step 2160: Test Loss = 0.1544






































































































































Steps:  29%|██▉       | 2180/7410 [10:34:36<19:30:16, 13.43s/it, lr=0.0001, step_loss=0.118]11/23/2024 21:21:16 - INFO - __main__ - Step 2180: Test Loss = 0.1913








































































































































Steps:  30%|██▉       | 2200/7410 [10:40:24<19:36:52, 13.55s/it, lr=0.0001, step_loss=0.185]11/23/2024 21:27:04 - INFO - __main__ - Step 2200: Test Loss = 0.1743
11/23/2024 21:27:04 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 404.02it/s]







































































































































Steps:  30%|██▉       | 2220/7410 [10:46:24<19:35:13, 13.59s/it, lr=0.0001, step_loss=0.126]11/23/2024 21:33:05 - INFO - __main__ - Step 2220: Test Loss = 0.1808
































































































































Steps:  30%|███       | 2240/7410 [10:52:17<19:30:05, 13.58s/it, lr=0.0001, step_loss=0.411]11/23/2024 21:38:59 - INFO - __main__ - Step 2240: Test Loss = 0.1531







































































































































Steps:  30%|███       | 2260/7410 [10:58:05<19:26:30, 13.59s/it, lr=0.0001, step_loss=0.0881]11/23/2024 21:44:47 - INFO - __main__ - Step 2260: Test Loss = 0.1784






































































































































Steps:  31%|███       | 2280/7410 [11:03:53<19:27:46, 13.66s/it, lr=0.0001, step_loss=0.055]11/23/2024 21:50:34 - INFO - __main__ - Step 2280: Test Loss = 0.1738






































































































































Steps:  31%|███       | 2300/7410 [11:09:40<19:09:15, 13.49s/it, lr=0.0001, step_loss=0.158]11/23/2024 21:56:22 - INFO - __main__ - Step 2300: Test Loss = 0.1824







































































































































Steps:  31%|███▏      | 2320/7410 [11:15:28<19:09:05, 13.55s/it, lr=0.0001, step_loss=0.228]11/23/2024 22:02:09 - INFO - __main__ - Step 2320: Test Loss = 0.1748







































































































































Steps:  32%|███▏      | 2340/7410 [11:21:16<19:11:05, 13.62s/it, lr=0.0001, step_loss=0.231]11/23/2024 22:07:56 - INFO - __main__ - Step 2340: Test Loss = 0.1634






































































































































Steps:  32%|███▏      | 2360/7410 [11:27:05<19:10:25, 13.67s/it, lr=0.0001, step_loss=0.11]11/23/2024 22:13:45 - INFO - __main__ - Step 2360: Test Loss = 0.1586






































































































































Steps:  32%|███▏      | 2380/7410 [11:32:54<18:58:33, 13.58s/it, lr=0.0001, step_loss=0.126]11/23/2024 22:19:35 - INFO - __main__ - Step 2380: Test Loss = 0.1653






































































































































Steps:  32%|███▏      | 2400/7410 [11:38:43<18:57:26, 13.62s/it, lr=0.0001, step_loss=0.0771]11/23/2024 22:25:24 - INFO - __main__ - Step 2400: Test Loss = 0.1751
11/23/2024 22:25:24 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 271.55it/s]




































































































































Steps:  33%|███▎      | 2420/7410 [11:44:43<18:45:21, 13.53s/it, lr=0.0001, step_loss=0.128]11/23/2024 22:31:24 - INFO - __main__ - Step 2420: Test Loss = 0.1799







































































































































Steps:  33%|███▎      | 2440/7410 [11:50:31<18:46:23, 13.60s/it, lr=0.0001, step_loss=0.123]11/23/2024 22:37:12 - INFO - __main__ - Step 2440: Test Loss = 0.1683







































































































































Steps:  33%|███▎      | 2460/7410 [11:56:19<18:45:30, 13.64s/it, lr=0.0001, step_loss=0.13]11/23/2024 22:43:01 - INFO - __main__ - Step 2460: Test Loss = 0.1840

































































































































Steps:  33%|███▎      | 2480/7410 [12:02:13<18:40:15, 13.63s/it, lr=0.0001, step_loss=0.228]11/23/2024 22:48:54 - INFO - __main__ - Step 2480: Test Loss = 0.1810







































































































































Steps:  34%|███▎      | 2500/7410 [12:07:59<18:21:03, 13.45s/it, lr=0.0001, step_loss=0.131]11/23/2024 22:54:40 - INFO - __main__ - Step 2500: Test Loss = 0.1507
11/23/2024 22:54:40 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/23/2024 22:54:40 - INFO - __main__ - removing checkpoints: checkpoint-2000
11/23/2024 22:54:41 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/controlnet/diffusion_pytorch_model.safetensors
11/23/2024 22:55:07 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/optimizer.bin
11/23/2024 22:55:07 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/scheduler.bin
11/23/2024 22:55:07 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/sampler.bin
11/23/2024 22:55:07 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/scaler.pt
11/23/2024 22:55:07 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500/random_states_0.pkl
11/23/2024 22:55:07 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-2500







































































































































Steps:  34%|███▍      | 2520/7410 [12:14:14<18:29:30, 13.61s/it, lr=0.0001, step_loss=0.258]11/23/2024 23:00:55 - INFO - __main__ - Step 2520: Test Loss = 0.1610







































































































































Steps:  34%|███▍      | 2540/7410 [12:20:02<18:22:50, 13.59s/it, lr=0.0001, step_loss=0.135]11/23/2024 23:06:42 - INFO - __main__ - Step 2540: Test Loss = 0.1664






































































































































Steps:  35%|███▍      | 2560/7410 [12:25:49<18:17:38, 13.58s/it, lr=0.0001, step_loss=0.355]11/23/2024 23:12:30 - INFO - __main__ - Step 2560: Test Loss = 0.1632





































































































































Steps:  35%|███▍      | 2580/7410 [12:31:37<18:09:25, 13.53s/it, lr=0.0001, step_loss=0.0618]11/23/2024 23:18:17 - INFO - __main__ - Step 2580: Test Loss = 0.1460








































































































































Steps:  35%|███▌      | 2600/7410 [12:37:25<18:11:11, 13.61s/it, lr=0.0001, step_loss=0.247]11/23/2024 23:24:06 - INFO - __main__ - Step 2600: Test Loss = 0.1549
11/23/2024 23:24:06 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 418.65it/s]








































































































































Steps:  35%|███▌      | 2620/7410 [12:43:26<18:02:40, 13.56s/it, lr=0.0001, step_loss=0.0794]11/23/2024 23:30:08 - INFO - __main__ - Step 2620: Test Loss = 0.1575







































































































































Steps:  36%|███▌      | 2640/7410 [12:49:14<18:15:02, 13.77s/it, lr=0.0001, step_loss=0.338]11/23/2024 23:35:55 - INFO - __main__ - Step 2640: Test Loss = 0.1862








































































































































Steps:  36%|███▌      | 2660/7410 [12:55:03<17:58:26, 13.62s/it, lr=0.0001, step_loss=0.499]11/23/2024 23:41:42 - INFO - __main__ - Step 2660: Test Loss = 0.1706































































































































Steps:  36%|███▌      | 2680/7410 [13:00:50<18:05:28, 13.77s/it, lr=0.0001, step_loss=0.187]11/23/2024 23:47:31 - INFO - __main__ - Step 2680: Test Loss = 0.1778






































































































































Steps:  36%|███▋      | 2700/7410 [13:06:37<17:42:09, 13.53s/it, lr=0.0001, step_loss=0.0719]11/23/2024 23:53:17 - INFO - __main__ - Step 2700: Test Loss = 0.1645































































































































Steps:  37%|███▋      | 2720/7410 [13:12:31<19:55:25, 15.29s/it, lr=0.0001, step_loss=0.328]11/23/2024 23:59:13 - INFO - __main__ - Step 2720: Test Loss = 0.1669





































































































































Steps:  37%|███▋      | 2740/7410 [13:18:19<17:32:26, 13.52s/it, lr=0.0001, step_loss=0.346]11/24/2024 00:05:00 - INFO - __main__ - Step 2740: Test Loss = 0.1722







































































































































Steps:  37%|███▋      | 2760/7410 [13:24:07<17:30:46, 13.56s/it, lr=0.0001, step_loss=0.439]11/24/2024 00:10:48 - INFO - __main__ - Step 2760: Test Loss = 0.1754






































































































































Steps:  38%|███▊      | 2780/7410 [13:29:55<17:22:37, 13.51s/it, lr=0.0001, step_loss=0.151]11/24/2024 00:16:36 - INFO - __main__ - Step 2780: Test Loss = 0.1873







































































































































Steps:  38%|███▊      | 2800/7410 [13:35:42<17:20:52, 13.55s/it, lr=0.0001, step_loss=0.101]11/24/2024 00:22:23 - INFO - __main__ - Step 2800: Test Loss = 0.1901
11/24/2024 00:22:23 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 145.32it/s]







































































































































Steps:  38%|███▊      | 2820/7410 [13:41:44<17:25:46, 13.67s/it, lr=0.0001, step_loss=0.255]11/24/2024 00:28:26 - INFO - __main__ - Step 2820: Test Loss = 0.1724






































































































































Steps:  38%|███▊      | 2840/7410 [13:47:32<17:06:16, 13.47s/it, lr=0.0001, step_loss=0.0898]11/24/2024 00:34:12 - INFO - __main__ - Step 2840: Test Loss = 0.1483







































































































































Steps:  39%|███▊      | 2860/7410 [13:53:21<17:23:32, 13.76s/it, lr=0.0001, step_loss=0.366]11/24/2024 00:40:01 - INFO - __main__ - Step 2860: Test Loss = 0.1717







































































































































Steps:  39%|███▉      | 2880/7410 [13:59:08<17:08:37, 13.62s/it, lr=0.0001, step_loss=0.175]11/24/2024 00:45:49 - INFO - __main__ - Step 2880: Test Loss = 0.1583







































































































































Steps:  39%|███▉      | 2900/7410 [14:04:56<16:53:05, 13.48s/it, lr=0.0001, step_loss=0.157]11/24/2024 00:51:37 - INFO - __main__ - Step 2900: Test Loss = 0.1856







































































































































Steps:  39%|███▉      | 2920/7410 [14:10:43<16:54:40, 13.56s/it, lr=0.0001, step_loss=0.071]11/24/2024 00:57:23 - INFO - __main__ - Step 2920: Test Loss = 0.1633







































































































































Steps:  40%|███▉      | 2940/7410 [14:16:30<16:50:11, 13.56s/it, lr=0.0001, step_loss=0.0914]11/24/2024 01:03:11 - INFO - __main__ - Step 2940: Test Loss = 0.1539





































































































































Steps:  40%|███▉      | 2960/7410 [14:22:19<16:50:56, 13.63s/it, lr=0.0001, step_loss=0.143]11/24/2024 01:09:00 - INFO - __main__ - Step 2960: Test Loss = 0.1564

































































































































Steps:  40%|████      | 2980/7410 [14:28:15<16:50:04, 13.68s/it, lr=0.0001, step_loss=0.11]11/24/2024 01:14:55 - INFO - __main__ - Step 2980: Test Loss = 0.1818






































































































































Steps:  40%|████      | 3000/7410 [14:34:03<16:36:38, 13.56s/it, lr=0.0001, step_loss=0.111]11/24/2024 01:20:45 - INFO - __main__ - Step 3000: Test Loss = 0.1752
11/24/2024 01:20:45 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/24/2024 01:20:45 - INFO - __main__ - removing checkpoints: checkpoint-2500
11/24/2024 01:20:46 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/controlnet/diffusion_pytorch_model.safetensors
11/24/2024 01:21:11 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/optimizer.bin
11/24/2024 01:21:11 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/scheduler.bin
11/24/2024 01:21:11 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/sampler.bin
11/24/2024 01:21:11 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/scaler.pt
11/24/2024 01:21:11 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000/random_states_0.pkl
11/24/2024 01:21:11 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3000
11/24/2024 01:21:11 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 472.29it/s]







































































































































Steps:  41%|████      | 3020/7410 [14:40:30<16:36:10, 13.62s/it, lr=0.0001, step_loss=0.162]11/24/2024 01:27:11 - INFO - __main__ - Step 3020: Test Loss = 0.1784







































































































































Steps:  41%|████      | 3040/7410 [14:46:18<16:24:47, 13.52s/it, lr=0.0001, step_loss=0.117]11/24/2024 01:33:00 - INFO - __main__ - Step 3040: Test Loss = 0.1752







































































































































Steps:  41%|████▏     | 3060/7410 [14:52:08<16:32:32, 13.69s/it, lr=0.0001, step_loss=0.195]11/24/2024 01:38:49 - INFO - __main__ - Step 3060: Test Loss = 0.1757








































































































































Steps:  42%|████▏     | 3080/7410 [14:57:57<16:29:28, 13.71s/it, lr=0.0001, step_loss=0.145]11/24/2024 01:44:38 - INFO - __main__ - Step 3080: Test Loss = 0.1759







































































































































Steps:  42%|████▏     | 3100/7410 [15:03:45<16:13:11, 13.55s/it, lr=0.0001, step_loss=0.279]11/24/2024 01:50:26 - INFO - __main__ - Step 3100: Test Loss = 0.1655






































































































































Steps:  42%|████▏     | 3120/7410 [15:09:33<16:05:22, 13.50s/it, lr=0.0001, step_loss=0.362]11/24/2024 01:56:14 - INFO - __main__ - Step 3120: Test Loss = 0.1581








































































































































Steps:  42%|████▏     | 3140/7410 [15:15:21<16:11:31, 13.65s/it, lr=0.0001, step_loss=0.122]11/24/2024 02:02:01 - INFO - __main__ - Step 3140: Test Loss = 0.1777







































































































































Steps:  43%|████▎     | 3160/7410 [15:21:10<16:16:20, 13.78s/it, lr=0.0001, step_loss=0.453]11/24/2024 02:07:52 - INFO - __main__ - Step 3160: Test Loss = 0.1811








































































































































Steps:  43%|████▎     | 3180/7410 [15:26:59<16:01:16, 13.64s/it, lr=0.0001, step_loss=0.247]11/24/2024 02:13:40 - INFO - __main__ - Step 3180: Test Loss = 0.1687








































































































































Steps:  43%|████▎     | 3200/7410 [15:32:48<15:54:59, 13.61s/it, lr=0.0001, step_loss=0.104]11/24/2024 02:19:29 - INFO - __main__ - Step 3200: Test Loss = 0.1690
11/24/2024 02:19:29 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 387.38it/s]
































































































































Steps:  43%|████▎     | 3220/7410 [15:38:57<16:07:28, 13.85s/it, lr=0.0001, step_loss=0.134]11/24/2024 02:25:39 - INFO - __main__ - Step 3220: Test Loss = 0.2002







































































































































Steps:  44%|████▎     | 3240/7410 [15:44:46<15:44:05, 13.58s/it, lr=0.0001, step_loss=0.0951]11/24/2024 02:31:27 - INFO - __main__ - Step 3240: Test Loss = 0.1788







































































































































Steps:  44%|████▍     | 3260/7410 [15:50:34<15:35:25, 13.52s/it, lr=0.0001, step_loss=0.259]11/24/2024 02:37:15 - INFO - __main__ - Step 3260: Test Loss = 0.1614








































































































































Steps:  44%|████▍     | 3280/7410 [15:56:23<15:40:03, 13.66s/it, lr=0.0001, step_loss=0.109]11/24/2024 02:43:04 - INFO - __main__ - Step 3280: Test Loss = 0.1676








































































































































Steps:  45%|████▍     | 3300/7410 [16:02:12<15:35:11, 13.65s/it, lr=0.0001, step_loss=0.119]11/24/2024 02:48:53 - INFO - __main__ - Step 3300: Test Loss = 0.1774







































































































































Steps:  45%|████▍     | 3320/7410 [16:08:00<15:29:40, 13.64s/it, lr=0.0001, step_loss=0.0931]11/24/2024 02:54:42 - INFO - __main__ - Step 3320: Test Loss = 0.1675







































































































































Steps:  45%|████▌     | 3340/7410 [16:13:49<15:24:11, 13.62s/it, lr=0.0001, step_loss=0.0907]11/24/2024 03:00:29 - INFO - __main__ - Step 3340: Test Loss = 0.1520






































































































































Steps:  45%|████▌     | 3360/7410 [16:19:37<15:16:55, 13.58s/it, lr=0.0001, step_loss=0.277]11/24/2024 03:06:19 - INFO - __main__ - Step 3360: Test Loss = 0.1468







































































































































Steps:  46%|████▌     | 3380/7410 [16:25:26<15:14:00, 13.61s/it, lr=0.0001, step_loss=0.17]11/24/2024 03:12:07 - INFO - __main__ - Step 3380: Test Loss = 0.1672








































































































































Steps:  46%|████▌     | 3400/7410 [16:31:16<15:09:14, 13.60s/it, lr=0.0001, step_loss=0.0594]11/24/2024 03:17:56 - INFO - __main__ - Step 3400: Test Loss = 0.1947
11/24/2024 03:17:56 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 201.39it/s]







































































































































Steps:  46%|████▌     | 3420/7410 [16:37:18<15:05:34, 13.62s/it, lr=0.0001, step_loss=0.0984]11/24/2024 03:23:59 - INFO - __main__ - Step 3420: Test Loss = 0.1799







































































































































Steps:  46%|████▋     | 3440/7410 [16:43:06<14:55:59, 13.54s/it, lr=0.0001, step_loss=0.484]11/24/2024 03:29:46 - INFO - __main__ - Step 3440: Test Loss = 0.1418

































































































































Steps:  47%|████▋     | 3460/7410 [16:49:03<17:56:52, 16.36s/it, lr=0.0001, step_loss=0.102]11/24/2024 03:35:44 - INFO - __main__ - Step 3460: Test Loss = 0.1642







































































































































Steps:  47%|████▋     | 3480/7410 [16:54:51<14:53:50, 13.65s/it, lr=0.0001, step_loss=0.141]11/24/2024 03:41:31 - INFO - __main__ - Step 3480: Test Loss = 0.1610








































































































































Steps:  47%|████▋     | 3500/7410 [17:00:39<14:49:54, 13.66s/it, lr=0.0001, step_loss=0.287]11/24/2024 03:47:21 - INFO - __main__ - Step 3500: Test Loss = 0.1677
11/24/2024 03:47:21 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/24/2024 03:47:21 - INFO - __main__ - removing checkpoints: checkpoint-3000
11/24/2024 03:47:22 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/controlnet/diffusion_pytorch_model.safetensors
11/24/2024 03:47:47 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/optimizer.bin
11/24/2024 03:47:47 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/scheduler.bin
11/24/2024 03:47:47 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/sampler.bin
11/24/2024 03:47:47 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/scaler.pt
11/24/2024 03:47:47 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500/random_states_0.pkl
11/24/2024 03:47:47 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-3500






































































































































Steps:  48%|████▊     | 3520/7410 [17:06:54<14:44:20, 13.64s/it, lr=0.0001, step_loss=0.107]11/24/2024 03:53:34 - INFO - __main__ - Step 3520: Test Loss = 0.1646






































































































































Steps:  48%|████▊     | 3540/7410 [17:12:42<14:33:53, 13.55s/it, lr=0.0001, step_loss=0.148]11/24/2024 03:59:23 - INFO - __main__ - Step 3540: Test Loss = 0.1482







































































































































Steps:  48%|████▊     | 3560/7410 [17:18:30<14:28:44, 13.54s/it, lr=0.0001, step_loss=0.149]11/24/2024 04:05:12 - INFO - __main__ - Step 3560: Test Loss = 0.1755







































































































































Steps:  48%|████▊     | 3580/7410 [17:24:18<14:20:56, 13.49s/it, lr=0.0001, step_loss=0.0881]11/24/2024 04:10:59 - INFO - __main__ - Step 3580: Test Loss = 0.1617






































































































































Steps:  49%|████▊     | 3600/7410 [17:30:07<14:25:31, 13.63s/it, lr=0.0001, step_loss=0.339]11/24/2024 04:16:47 - INFO - __main__ - Step 3600: Test Loss = 0.1525
11/24/2024 04:16:47 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 213.09it/s]







































































































































Steps:  49%|████▉     | 3620/7410 [17:36:07<14:19:04, 13.60s/it, lr=0.0001, step_loss=0.154]11/24/2024 04:22:47 - INFO - __main__ - Step 3620: Test Loss = 0.1681








































































































































Steps:  49%|████▉     | 3640/7410 [17:41:55<14:15:11, 13.61s/it, lr=0.0001, step_loss=0.313]11/24/2024 04:28:36 - INFO - __main__ - Step 3640: Test Loss = 0.1990







































































































































Steps:  49%|████▉     | 3660/7410 [17:47:44<14:11:13, 13.62s/it, lr=0.0001, step_loss=0.413]11/24/2024 04:34:24 - INFO - __main__ - Step 3660: Test Loss = 0.1492







































































































































Steps:  50%|████▉     | 3680/7410 [17:53:31<13:57:13, 13.47s/it, lr=0.0001, step_loss=0.361]11/24/2024 04:40:13 - INFO - __main__ - Step 3680: Test Loss = 0.1700








































































































































Steps:  50%|████▉     | 3700/7410 [17:59:21<14:01:05, 13.60s/it, lr=0.0001, step_loss=0.436]11/24/2024 04:46:02 - INFO - __main__ - Step 3700: Test Loss = 0.1535
































































































































Steps:  50%|█████     | 3720/7410 [18:05:16<13:54:42, 13.57s/it, lr=0.0001, step_loss=0.171]11/24/2024 04:51:56 - INFO - __main__ - Step 3720: Test Loss = 0.1896







































































































































Steps:  50%|█████     | 3740/7410 [18:11:04<13:53:49, 13.63s/it, lr=0.0001, step_loss=0.084]11/24/2024 04:57:44 - INFO - __main__ - Step 3740: Test Loss = 0.1419








































































































































Steps:  51%|█████     | 3760/7410 [18:16:53<13:47:55, 13.61s/it, lr=0.0001, step_loss=0.0719]11/24/2024 05:03:34 - INFO - __main__ - Step 3760: Test Loss = 0.1746







































































































































Steps:  51%|█████     | 3780/7410 [18:22:41<13:41:08, 13.57s/it, lr=0.0001, step_loss=0.248]11/24/2024 05:09:22 - INFO - __main__ - Step 3780: Test Loss = 0.1600






































































































































Steps:  51%|█████▏    | 3800/7410 [18:28:28<13:37:16, 13.58s/it, lr=0.0001, step_loss=0.0882]11/24/2024 05:15:09 - INFO - __main__ - Step 3800: Test Loss = 0.1591
11/24/2024 05:15:09 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 224.82it/s]






































































































































Steps:  52%|█████▏    | 3820/7410 [18:34:28<13:31:30, 13.56s/it, lr=0.0001, step_loss=0.128]11/24/2024 05:21:11 - INFO - __main__ - Step 3820: Test Loss = 0.1811








































































































































Steps:  52%|█████▏    | 3840/7410 [18:40:17<13:29:44, 13.61s/it, lr=0.0001, step_loss=0.223]11/24/2024 05:26:58 - INFO - __main__ - Step 3840: Test Loss = 0.1816







































































































































Steps:  52%|█████▏    | 3860/7410 [18:46:06<13:24:32, 13.60s/it, lr=0.0001, step_loss=0.119]11/24/2024 05:32:46 - INFO - __main__ - Step 3860: Test Loss = 0.1575







































































































































Steps:  52%|█████▏    | 3880/7410 [18:51:54<13:18:01, 13.56s/it, lr=0.0001, step_loss=0.0847]11/24/2024 05:38:35 - INFO - __main__ - Step 3880: Test Loss = 0.1759






































































































































Steps:  53%|█████▎    | 3900/7410 [18:57:42<13:18:43, 13.65s/it, lr=0.0001, step_loss=0.21]11/24/2024 05:44:23 - INFO - __main__ - Step 3900: Test Loss = 0.1543






































































































































Steps:  53%|█████▎    | 3920/7410 [19:03:31<13:15:29, 13.68s/it, lr=0.0001, step_loss=0.126]11/24/2024 05:50:11 - INFO - __main__ - Step 3920: Test Loss = 0.1462







































































































































Steps:  53%|█████▎    | 3940/7410 [19:09:19<13:08:06, 13.63s/it, lr=0.0001, step_loss=0.078]11/24/2024 05:56:01 - INFO - __main__ - Step 3940: Test Loss = 0.1648

































































































































Steps:  53%|█████▎    | 3960/7410 [19:15:15<13:22:54, 13.96s/it, lr=0.0001, step_loss=0.231]11/24/2024 06:01:55 - INFO - __main__ - Step 3960: Test Loss = 0.1693







































































































































Steps:  54%|█████▎    | 3980/7410 [19:21:03<12:55:45, 13.57s/it, lr=0.0001, step_loss=0.194]11/24/2024 06:07:44 - INFO - __main__ - Step 3980: Test Loss = 0.1817







































































































































Steps:  54%|█████▍    | 4000/7410 [19:26:51<12:43:23, 13.43s/it, lr=0.0001, step_loss=0.374]11/24/2024 06:13:32 - INFO - __main__ - Step 4000: Test Loss = 0.1554
11/24/2024 06:13:32 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/24/2024 06:13:32 - INFO - __main__ - removing checkpoints: checkpoint-3500
11/24/2024 06:13:33 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/controlnet/diffusion_pytorch_model.safetensors
11/24/2024 06:13:59 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/optimizer.bin
11/24/2024 06:13:59 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/scheduler.bin
11/24/2024 06:13:59 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/sampler.bin
11/24/2024 06:13:59 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/scaler.pt
11/24/2024 06:13:59 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000/random_states_0.pkl
11/24/2024 06:13:59 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4000
11/24/2024 06:13:59 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 509.52it/s]






































































































































Steps:  54%|█████▍    | 4020/7410 [19:33:17<12:46:06, 13.56s/it, lr=0.0001, step_loss=0.157]11/24/2024 06:19:58 - INFO - __main__ - Step 4020: Test Loss = 0.1897








































































































































Steps:  55%|█████▍    | 4040/7410 [19:39:07<12:52:54, 13.76s/it, lr=0.0001, step_loss=0.0988]11/24/2024 06:25:47 - INFO - __main__ - Step 4040: Test Loss = 0.1519







































































































































Steps:  55%|█████▍    | 4060/7410 [19:44:55<12:41:12, 13.63s/it, lr=0.0001, step_loss=0.118]11/24/2024 06:31:37 - INFO - __main__ - Step 4060: Test Loss = 0.1795






































































































































Steps:  55%|█████▌    | 4080/7410 [19:50:44<12:33:35, 13.58s/it, lr=0.0001, step_loss=0.197]11/24/2024 06:37:24 - INFO - __main__ - Step 4080: Test Loss = 0.1576






































































































































Steps:  55%|█████▌    | 4100/7410 [19:56:32<12:25:30, 13.51s/it, lr=0.0001, step_loss=0.191]11/24/2024 06:43:13 - INFO - __main__ - Step 4100: Test Loss = 0.1712






































































































































Steps:  56%|█████▌    | 4120/7410 [20:02:19<12:21:08, 13.52s/it, lr=0.0001, step_loss=0.1]11/24/2024 06:49:01 - INFO - __main__ - Step 4120: Test Loss = 0.1775







































































































































Steps:  56%|█████▌    | 4140/7410 [20:08:08<12:23:37, 13.64s/it, lr=0.0001, step_loss=0.312]11/24/2024 06:54:50 - INFO - __main__ - Step 4140: Test Loss = 0.1556







































































































































Steps:  56%|█████▌    | 4160/7410 [20:13:56<12:17:19, 13.61s/it, lr=0.0001, step_loss=0.0639]11/24/2024 07:00:38 - INFO - __main__ - Step 4160: Test Loss = 0.1857







































































































































Steps:  56%|█████▋    | 4180/7410 [20:19:44<12:08:37, 13.53s/it, lr=0.0001, step_loss=0.181]11/24/2024 07:06:25 - INFO - __main__ - Step 4180: Test Loss = 0.1728

































































































































Steps:  57%|█████▋    | 4200/7410 [20:25:39<15:26:56, 17.33s/it, lr=0.0001, step_loss=0.143]11/24/2024 07:12:20 - INFO - __main__ - Step 4200: Test Loss = 0.1532
11/24/2024 07:12:20 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 400.68it/s]







































































































































Steps:  57%|█████▋    | 4220/7410 [20:31:40<12:03:40, 13.61s/it, lr=0.0001, step_loss=0.11]11/24/2024 07:18:22 - INFO - __main__ - Step 4220: Test Loss = 0.1591






































































































































Steps:  57%|█████▋    | 4240/7410 [20:37:28<11:56:45, 13.57s/it, lr=0.0001, step_loss=0.0711]11/24/2024 07:24:10 - INFO - __main__ - Step 4240: Test Loss = 0.1696






































































































































Steps:  57%|█████▋    | 4260/7410 [20:43:17<11:55:18, 13.63s/it, lr=0.0001, step_loss=0.0928]11/24/2024 07:29:57 - INFO - __main__ - Step 4260: Test Loss = 0.1607






































































































































Steps:  58%|█████▊    | 4280/7410 [20:49:05<11:48:41, 13.59s/it, lr=0.0001, step_loss=0.379]11/24/2024 07:35:46 - INFO - __main__ - Step 4280: Test Loss = 0.1737





































































































































Steps:  58%|█████▊    | 4300/7410 [20:54:54<11:43:20, 13.57s/it, lr=0.0001, step_loss=0.203]11/24/2024 07:41:36 - INFO - __main__ - Step 4300: Test Loss = 0.1531







































































































































Steps:  58%|█████▊    | 4320/7410 [21:00:43<11:40:00, 13.59s/it, lr=0.0001, step_loss=0.106]11/24/2024 07:47:23 - INFO - __main__ - Step 4320: Test Loss = 0.1642






































































































































Steps:  59%|█████▊    | 4340/7410 [21:06:32<11:38:35, 13.65s/it, lr=0.0001, step_loss=0.263]11/24/2024 07:53:13 - INFO - __main__ - Step 4340: Test Loss = 0.1803








































































































































Steps:  59%|█████▉    | 4360/7410 [21:12:21<11:34:29, 13.66s/it, lr=0.0001, step_loss=0.332]11/24/2024 07:59:02 - INFO - __main__ - Step 4360: Test Loss = 0.1659








































































































































Steps:  59%|█████▉    | 4380/7410 [21:18:10<11:28:07, 13.63s/it, lr=0.0001, step_loss=0.333]11/24/2024 08:04:51 - INFO - __main__ - Step 4380: Test Loss = 0.1693








































































































































Steps:  59%|█████▉    | 4400/7410 [21:23:59<11:21:12, 13.58s/it, lr=0.0001, step_loss=0.121]11/24/2024 08:10:40 - INFO - __main__ - Step 4400: Test Loss = 0.1405
11/24/2024 08:10:40 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 283.63it/s]







































































































































Steps:  60%|█████▉    | 4420/7410 [21:30:00<11:13:30, 13.52s/it, lr=0.0001, step_loss=0.0928]11/24/2024 08:16:42 - INFO - __main__ - Step 4420: Test Loss = 0.1842







































































































































Steps:  60%|█████▉    | 4440/7410 [21:35:49<11:10:23, 13.54s/it, lr=0.0001, step_loss=0.268]11/24/2024 08:22:30 - INFO - __main__ - Step 4440: Test Loss = 0.1621

































































































































Steps:  60%|██████    | 4460/7410 [21:41:45<11:13:11, 13.69s/it, lr=0.0001, step_loss=0.101]11/24/2024 08:28:25 - INFO - __main__ - Step 4460: Test Loss = 0.1707







































































































































Steps:  60%|██████    | 4480/7410 [21:47:33<11:03:02, 13.58s/it, lr=0.0001, step_loss=0.165]11/24/2024 08:34:15 - INFO - __main__ - Step 4480: Test Loss = 0.1603








































































































































Steps:  61%|██████    | 4500/7410 [21:53:23<11:01:38, 13.64s/it, lr=0.0001, step_loss=0.211]11/24/2024 08:40:04 - INFO - __main__ - Step 4500: Test Loss = 0.1782
11/24/2024 08:40:04 - INFO - __main__ - 1 checkpoints already exist, removing 1 checkpoints
11/24/2024 08:40:04 - INFO - __main__ - removing checkpoints: checkpoint-4000
11/24/2024 08:40:05 - INFO - accelerate.accelerator - Saving current state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/controlnet/diffusion_pytorch_model.safetensors
Configuration saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/controlnet/config.json
Model weights saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/controlnet/diffusion_pytorch_model.safetensors
11/24/2024 08:40:30 - INFO - accelerate.checkpointing - Optimizer state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/optimizer.bin
11/24/2024 08:40:30 - INFO - accelerate.checkpointing - Scheduler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/scheduler.bin
11/24/2024 08:40:30 - INFO - accelerate.checkpointing - Sampler state for dataloader 0 saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/sampler.bin
11/24/2024 08:40:30 - INFO - accelerate.checkpointing - Gradient scaler state saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/scaler.pt
11/24/2024 08:40:30 - INFO - accelerate.checkpointing - Random states saved in /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500/random_states_0.pkl
11/24/2024 08:40:30 - INFO - __main__ - Saved state to /fs/nexus-scratch/sjxu/Model_out/model_out/checkpoint-4500









































































































































Steps:  61%|██████    | 4520/7410 [21:59:37<10:59:37, 13.69s/it, lr=0.0001, step_loss=0.48]11/24/2024 08:46:18 - INFO - __main__ - Step 4520: Test Loss = 0.1630








































































































































Steps:  61%|██████▏   | 4540/7410 [22:05:27<10:56:13, 13.72s/it, lr=0.0001, step_loss=0.162]11/24/2024 08:52:07 - INFO - __main__ - Step 4540: Test Loss = 0.1791








































































































































Steps:  62%|██████▏   | 4560/7410 [22:11:15<10:52:01, 13.73s/it, lr=0.0001, step_loss=0.148]11/24/2024 08:57:55 - INFO - __main__ - Step 4560: Test Loss = 0.1539




































































































































Steps:  62%|██████▏   | 4580/7410 [22:17:03<10:39:09, 13.55s/it, lr=0.0001, step_loss=0.083]11/24/2024 09:03:45 - INFO - __main__ - Step 4580: Test Loss = 0.1723






































































































































Steps:  62%|██████▏   | 4600/7410 [22:22:53<10:38:14, 13.63s/it, lr=0.0001, step_loss=0.465]11/24/2024 09:09:34 - INFO - __main__ - Step 4600: Test Loss = 0.1690
11/24/2024 09:09:34 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 312.24it/s]







































































































































Steps:  62%|██████▏   | 4620/7410 [22:28:55<10:32:21, 13.60s/it, lr=0.0001, step_loss=0.225]11/24/2024 09:15:35 - INFO - __main__ - Step 4620: Test Loss = 0.1657






































































































































Steps:  63%|██████▎   | 4640/7410 [22:34:45<10:30:09, 13.65s/it, lr=0.0001, step_loss=0.0647]11/24/2024 09:21:25 - INFO - __main__ - Step 4640: Test Loss = 0.1714






































































































































Steps:  63%|██████▎   | 4660/7410 [22:40:33<10:26:25, 13.67s/it, lr=0.0001, step_loss=0.531]11/24/2024 09:27:15 - INFO - __main__ - Step 4660: Test Loss = 0.2031







































































































































Steps:  63%|██████▎   | 4680/7410 [22:46:22<10:22:37, 13.68s/it, lr=0.0001, step_loss=0.162]11/24/2024 09:33:03 - INFO - __main__ - Step 4680: Test Loss = 0.1835
































































































































Steps:  63%|██████▎   | 4700/7410 [22:52:18<10:41:02, 14.19s/it, lr=0.0001, step_loss=0.0941]11/24/2024 09:38:58 - INFO - __main__ - Step 4700: Test Loss = 0.1565








































































































































Steps:  64%|██████▎   | 4720/7410 [22:58:07<10:09:40, 13.60s/it, lr=0.0001, step_loss=0.1]11/24/2024 09:44:48 - INFO - __main__ - Step 4720: Test Loss = 0.1652







































































































































Steps:  64%|██████▍   | 4740/7410 [23:03:54<10:01:17, 13.51s/it, lr=0.0001, step_loss=0.23]11/24/2024 09:50:35 - INFO - __main__ - Step 4740: Test Loss = 0.1553








































































































































Steps:  64%|██████▍   | 4760/7410 [23:09:42<9:56:58, 13.52s/it, lr=0.0001, step_loss=0.0722]11/24/2024 09:56:24 - INFO - __main__ - Step 4760: Test Loss = 0.1544







































































































































Steps:  65%|██████▍   | 4780/7410 [23:15:31<9:56:27, 13.61s/it, lr=0.0001, step_loss=0.368]11/24/2024 10:02:12 - INFO - __main__ - Step 4780: Test Loss = 0.1631







































































































































Steps:  65%|██████▍   | 4800/7410 [23:21:19<9:55:15, 13.68s/it, lr=0.0001, step_loss=0.153]11/24/2024 10:08:00 - INFO - __main__ - Step 4800: Test Loss = 0.1610
11/24/2024 10:08:00 - INFO - __main__ - Running validation...
 Generating 1 videos.
{'controlnet'} was not found in config. Values will be initialized to default values.
                                                                     Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
{'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 440.29it/s]






































































































































Steps:  65%|██████▌   | 4820/7410 [23:27:19<9:47:34, 13.61s/it, lr=0.0001, step_loss=0.369]11/24/2024 10:14:01 - INFO - __main__ - Step 4820: Test Loss = 0.1578







































































































































Steps:  65%|██████▌   | 4840/7410 [23:33:07<9:42:05, 13.59s/it, lr=0.0001, step_loss=0.0958]11/24/2024 10:19:48 - INFO - __main__ - Step 4840: Test Loss = 0.1764







































































































































Steps:  66%|██████▌   | 4860/7410 [23:38:56<9:39:01, 13.62s/it, lr=0.0001, step_loss=0.0827]11/24/2024 10:25:37 - INFO - __main__ - Step 4860: Test Loss = 0.1613






































































































































Steps:  66%|██████▌   | 4880/7410 [23:44:44<9:31:02, 13.54s/it, lr=0.0001, step_loss=0.451]11/24/2024 10:31:25 - INFO - __main__ - Step 4880: Test Loss = 0.1511







































































































































Steps:  66%|██████▌   | 4900/7410 [23:50:33<9:28:09, 13.58s/it, lr=0.0001, step_loss=0.114]11/24/2024 10:37:14 - INFO - __main__ - Step 4900: Test Loss = 0.1697







































































































































Steps:  66%|██████▋   | 4920/7410 [23:56:21<9:23:07, 13.57s/it, lr=0.0001, step_loss=0.319]11/24/2024 10:43:03 - INFO - __main__ - Step 4920: Test Loss = 0.1417
































