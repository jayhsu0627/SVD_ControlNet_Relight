INFO:__main__:***** Running training *****
INFO:__main__:  Num examples = 4728
INFO:__main__:  Num Epochs = 120
INFO:__main__:  Instantaneous batch size per device = 1
INFO:__main__:  Total train batch size (w. parallel, distributed & accumulation) = 64
INFO:__main__:  Gradient Accumulation steps = 16
INFO:__main__:  Total optimization steps = 8880









Steps:   0%|          | 1/8880 [00:28<69:58:21, 28.37s/it, lr=0.0001, step_loss=0.308]INFO:__main__:Running validation...
 Generating 1 videos.
{'insert_light', 'controlnet', 'multi_frame'} was not found in config. Values will be initialized to default values.
                                                                     {'rescale_betas_zero_snr', 'final_sigmas_type'} was not found in config. Values will be initialized to default values.
Loaded scheduler as EulerDiscreteScheduler from `scheduler` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of stabilityai/stable-video-diffusion-img2vid.
Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00, 275.92it/s]























































































Steps:   0%|          | 10/8880 [03:36<48:46:13, 19.79s/it, lr=0.0001, step_loss=0.162]Traceback (most recent call last):
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 2023, in <module>
    main()
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1777, in main
    test_loss = evaluate_on_test_set(
  File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1362, in evaluate_on_test_set
    conditional_pixel_values = controlnet_image.to(latents)
UnboundLocalError: local variable 'latents' referenced before assignment
[rank0]: Traceback (most recent call last):
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 2023, in <module>
[rank0]:     main()
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1777, in main
[rank0]:     test_loss = evaluate_on_test_set(
[rank0]:   File "/fs/nexus-scratch/sjxu/svd-temporal-controlnet/train_svd_controlnet.py", line 1362, in evaluate_on_test_set
[rank0]:     conditional_pixel_values = controlnet_image.to(latents)
[rank0]: UnboundLocalError: local variable 'latents' referenced before assignment